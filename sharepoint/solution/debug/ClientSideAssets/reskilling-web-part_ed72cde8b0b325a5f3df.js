/*! For license information please see reskilling-web-part_ed72cde8b0b325a5f3df.js.LICENSE.txt */
define("e717724a-1132-47a9-a71e-d2d880162870_0.0.1",["react","react-dom","@microsoft/sp-webpart-base"],(e,t,n)=>(()=>{"use strict";var a={777:(e,t)=>{Object.prototype.toString}
,745:(e,t,n)=>{var a=n(729);t.s=a.createRoot,a.hydrateRoot}
,134:e=>{e.exports=n},650:t=>{t.exports=e},729:e=>{e.exports=t}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{default:()=>Rs});var e=r(650),t=r(745),n=r(134),a=(r(777),"popstate");function i(e,t){if(!1===e||null==e)throw new Error(t)}function s(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,n=null,a){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?u(t):t,state:n,key:t&&t.key||a||Math.random().toString(36).substring(2,10)}}function l({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function u(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function f(e,t,n="/"){return function(e,t,n){let a=O(("string"==typeof t?u(t):t).pathname||"/",n);if(null==a)return null;let i=p(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n])?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let r=null;for(let e=0;null==r&&e<i.length;++e){let t=C(a);r=I(i[e],t,false)}return r}(e,t,n)}function p(e,t=[],n=[],a=""){let r=(e,r,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};s.relativePath.startsWith("/")&&(i(s.relativePath.startsWith(a),`Absolute route path "${s.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(a.length));let c=L([a,s.relativePath]),d=n.concat(s);e.children&&e.children.length>0&&(i(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),p(e.children,t,d,c)),(null!=e.path||e.index)&&t.push({path:c,score:D(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of m(e.path))r(e,t,n);else r(e,t)}),t}function m(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(0===a.length)return i?[r,""]:[r];let o=m(a.join("/")),s=[];return s.push(...o.map(e=>""===e?r:[r,e].join("/"))),i&&s.push(...o),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var _=/^:[\w-]+$/,h=3,b=2,g=1,v=10,y=-2,S=e=>"*"===e;function D(e,t){let n=e.split("/"),a=n.length;return n.some(S)&&(a+=y),t&&(a+=b),n.filter(e=>!S(e)).reduce((e,t)=>e+(_.test(t)?h:""===t?g:v),a)}function I(e,t,n=!1){let{routesMeta:a}=e,i={},r="/",o=[];for(let e=0;e<a.length;++e){let s=a[e],c=e===a.length-1,d="/"===r?t:t.slice(r.length)||"/",l=x({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},d),u=s.route;if(!l&&c&&n&&!a[a.length-1].route.index&&(l=x({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},d)),!l)return null;Object.assign(i,l.params),o.push({params:i,pathname:L([r,l.pathname]),pathnameBase:k(L([r,l.pathnameBase])),route:u}),"/"!==l.pathnameBase&&(r=L([r,l.pathnameBase]))}return o}function x(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t=!1,n=!0){s("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),a]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:a.reduce((e,{paramName:t,isOptional:n},a)=>{if("*"===t){let e=c[a]||"";o=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const i=c[a];return e[t]=n&&!i?void 0:(i||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:o,pattern:e}}function C(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return s(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function O(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function w(e,t,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function E(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function A(e,t,n,a=!1){let r;"string"==typeof e?r=u(e):(r={...e},i(!r.pathname||!r.pathname.includes("?"),w("?","pathname","search",r)),i(!r.pathname||!r.pathname.includes("#"),w("#","pathname","hash",r)),i(!r.search||!r.search.includes("#"),w("#","search","hash",r)));let o,s=""===e||""===r.pathname,c=s?"/":r.pathname;if(null==c)o=n;else{let e=t.length-1;if(!a&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let d=function(e,t="/"){let{pathname:n,search:a="",hash:i=""}="string"==typeof e?u(e):e,r=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:r,search:M(a),hash:P(i)}}(r,o),l=c&&"/"!==c&&c.endsWith("/"),f=(s||"."===c)&&n.endsWith("/");return d.pathname.endsWith("/")||!l&&!f||(d.pathname+="/"),d}var L=e=>e.join("/").replace(/\/\/+/g,"/"),k=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",P=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";var T=["POST","PUT","PATCH","DELETE"],U=(new Set(T),["GET",...T]);new Set(U),Symbol("ResetLoaderData");var F=e.createContext(null);F.displayName="DataRouter";var H=e.createContext(null);H.displayName="DataRouterState";var R=e.createContext({isTransitioning:!1});R.displayName="ViewTransition",e.createContext(new Map).displayName="Fetchers",e.createContext(null).displayName="Await";var N=e.createContext(null);N.displayName="Navigation";var B=e.createContext(null);B.displayName="Location";var j=e.createContext({outlet:null,matches:[],isDataRoute:!1});j.displayName="Route";var V=e.createContext(null);function z(){return null!=e.useContext(B)}function G(){return i(z(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(B).location}V.displayName="RouteError";var K="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function W(t){e.useContext(N).static||e.useLayoutEffect(t)}function q(){let{isDataRoute:t}=e.useContext(j);return t?function(){let{router:t}=function(){let t=e.useContext(F);return i(t,ee("useNavigate")),t}(),n=te("useNavigate"),a=e.useRef(!1);return W(()=>{a.current=!0}),e.useCallback(async(e,i={})=>{s(a.current,K),a.current&&("number"==typeof e?t.navigate(e):await t.navigate(e,{fromRouteId:n,...i}))},[t,n])}():function(){i(z(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(F),{basename:n,navigator:a}=e.useContext(N),{matches:r}=e.useContext(j),{pathname:o}=G(),c=JSON.stringify(E(r)),d=e.useRef(!1);return W(()=>{d.current=!0}),e.useCallback((e,i={})=>{if(s(d.current,K),!d.current)return;if("number"==typeof e)return void a.go(e);let r=A(e,JSON.parse(c),o,"path"===i.relative);null==t&&"/"!==n&&(r.pathname="/"===r.pathname?n:L([n,r.pathname])),(i.replace?a.replace:a.push)(r,i.state,i)},[n,a,c,o,t])}()}function Q(t,{relative:n}={}){let{matches:a}=e.useContext(j),{pathname:i}=G(),r=JSON.stringify(E(a));return e.useMemo(()=>A(t,JSON.parse(r),i,"path"===n),[t,r,i,n])}function Y(t,n,a,r){i(z(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=e.useContext(N),{matches:c}=e.useContext(j),d=c[c.length-1],l=d?d.params:{},p=(d&&d.pathname,d?d.pathnameBase:"/");d&&d.route;let m,_=G();if(n){let e="string"==typeof n?u(n):n;i("/"===p||e.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${e.pathname}" was given in the \`location\` prop.`),m=e}else m=_;let h=m.pathname||"/",b=h;if("/"!==p){let e=p.replace(/^\//,"").split("/");b="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let g=f(t,{pathname:b}),v=function(t,n=[],a=null){if(null==t){if(!a)return null;if(a.errors)t=a.matches;else{if(0!==n.length||a.initialized||!(a.matches.length>0))return null;t=a.matches}}let r=t,o=a?.errors;if(null!=o){let e=r.findIndex(e=>e.route.id&&void 0!==o?.[e.route.id]);i(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let c=!1,d=-1;if(a)for(let e=0;e<r.length;e++){let t=r[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(d=e),t.route.id){let{loaderData:e,errors:n}=a,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||i){c=!0,r=d>=0?r.slice(0,d+1):[r[0]];break}}}return r.reduceRight((t,i,l)=>{let u,f=!1,p=null,m=null;var _;a&&(u=o&&i.route.id?o[i.route.id]:void 0,p=i.route.errorElement||X,c&&(d<0&&0===l?(ne[_="route-fallback"]||(ne[_]=!0,s(!1,"No `HydrateFallback` element provided to render during initial hydration")),f=!0,m=null):d===l&&(f=!0,m=i.route.hydrateFallbackElement||null)));let h=n.concat(r.slice(0,l+1)),b=()=>{let n;return n=u?p:f?m:i.route.Component?e.createElement(i.route.Component,null):i.route.element?i.route.element:t,e.createElement($,{match:i,routeContext:{outlet:t,matches:h,isDataRoute:null!=a},children:n})};return a&&(i.route.ErrorBoundary||i.route.errorElement||0===l)?e.createElement(Z,{location:a.location,revalidation:a.revalidation,component:p,error:u,children:b(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):b()},null)}(g&&g.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:L([p,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:L([p,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),c,a);return n&&v?e.createElement(B.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},v):v}function J(){let t=function(){let t=e.useContext(V),n=function(){let t=e.useContext(H);return i(t,ee("useRouteError")),t}(),a=te("useRouteError");return void 0!==t?t:n.errors?.[a]}(),n=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null;return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),a?e.createElement("pre",{style:{padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"}},a):null,null)}e.createContext(null);var X=e.createElement(J,null),Z=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?e.createElement(j.Provider,{value:this.props.routeContext},e.createElement(V.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $({routeContext:t,match:n,children:a}){let i=e.useContext(F);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),e.createElement(j.Provider,{value:t},a)}function ee(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function te(t){let n=function(t){let n=e.useContext(j);return i(n,ee(t)),n}(t),a=n.matches[n.matches.length-1];return i(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}var ne={};function ae({to:t,replace:n,state:a,relative:r}){i(z(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=e.useContext(N);s(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=e.useContext(j),{pathname:d}=G(),l=q(),u=A(t,E(c),d,"path"===r),f=JSON.stringify(u);return e.useEffect(()=>{l(JSON.parse(f),{replace:n,state:a,relative:r})},[l,f,r,n,a]),null}function ie(e){i(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function re({basename:t="/",children:n=null,location:a,navigationType:r="POP",navigator:o,static:c=!1}){i(!z(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),l=e.useMemo(()=>({basename:d,navigator:o,static:c,future:{}}),[d,o,c]);"string"==typeof a&&(a=u(a));let{pathname:f="/",search:p="",hash:m="",state:_=null,key:h="default"}=a,b=e.useMemo(()=>{let e=O(f,d);return null==e?null:{location:{pathname:e,search:p,hash:m,state:_,key:h},navigationType:r}},[d,f,p,m,_,h,r]);return s(null!=b,`<Router basename="${d}"> is not able to match the URL "${f}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),null==b?null:e.createElement(N.Provider,{value:l},e.createElement(B.Provider,{children:n,value:b}))}function oe({children:e,location:t}){return Y(se(e),t)}function se(t,n=[]){let a=[];return e.Children.forEach(t,(t,r)=>{if(!e.isValidElement(t))return;let o=[...n,r];if(t.type===e.Fragment)return void a.push.apply(a,se(t.props.children,o));i(t.type===ie,`[${"string"==typeof t.type?t.type:t.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),i(!t.props.index||!t.props.children,"An index route cannot have child routes.");let s={id:t.props.id||o.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(s.children=se(t.props.children,o)),a.push(s)}),a}e.memo(function({routes:e,future:t,state:n}){return Y(e,void 0,n)}),e.Component;var ce="get",de="application/x-www-form-urlencoded";function le(e){return null!=e&&"string"==typeof e.tagName}var ue=null,fe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pe(e){return null==e||fe.has(e)?e:(s(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${de}"`),null)}function me(e,t){if(!1===e||null==e)throw new Error(t)}function _e(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function he(e,t,n,a,i,r){let o=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===r?t.filter((e,t)=>o(e,t)||s(e,t)):"data"===r?t.filter((t,r)=>{let c=a.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(o(t,r)||s(t,r))return!0;if(t.route.shouldRevalidate){let a=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof a)return a}return!0}):[]}Symbol("SingleFetchRedirect"),e.Component;var be=e.createContext(void 0);function ge(){let t=e.useContext(be);return me(t,"You must render this element inside a <HydratedRouter> element"),t}function ve(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ye({page:t,...n}){let{router:a}=function(){let t=e.useContext(F);return me(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}(),i=e.useMemo(()=>f(a.routes,t,a.basename),[a.routes,t,a.basename]);return i?e.createElement(Se,{page:t,matches:i,...n}):(console.warn(`Tried to prefetch ${t} but no routes matched.`),null)}function Se({page:t,matches:n,...a}){let i=G(),{manifest:r,routeModules:o}=ge(),{loaderData:s,matches:c}=function(){let t=e.useContext(H);return me(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}(),d=e.useMemo(()=>he(t,n,c,r,i,"data"),[t,n,c,r,i]),l=e.useMemo(()=>he(t,n,c,r,i,"assets"),[t,n,c,r,i]),u=e.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let e=new Set,a=!1;if(n.forEach(t=>{let n=r.routes[t.route.id];n&&n.hasLoader&&(!d.some(e=>e.route.id===t.route.id)&&t.route.id in s&&o[t.route.id]?.shouldRevalidate||n.hasClientLoader?a=!0:e.add(t.route.id))}),0===e.size)return[];let c=function(e){let t="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===t.pathname?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}(t);return a&&e.size>0&&c.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[c.pathname+c.search]},[s,i,r,d,n,t,o]),f=e.useMemo(()=>function(e,t){return n=e.map(e=>{let n=t.routes[e.route.id];if(!n)return[];let a=[n.module];return n.imports&&(a=a.concat(n.imports)),a}).flat(1),[...new Set(n)];var n}(l,r),[l,r]),p=function(t){let{manifest:n,routeModules:a}=ge(),[i,r]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,n){return function(e,t){let n=new Set;return new Set(t),e.reduce((e,t)=>{let a=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}(t));return n.has(a)||(n.add(a),e.push({key:a,link:t})),e},[])}((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(a,n);return e.links?e.links():[]}return[]}))).flat(1).filter(_e).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}(t,n,a).then(t=>{e||r(t)}),()=>{e=!0}},[t,n,a]),i}(l);return e.createElement(e.Fragment,null,u.map(t=>e.createElement("link",{key:t,rel:"prefetch",as:"fetch",href:t,...a})),f.map(t=>e.createElement("link",{key:t,rel:"modulepreload",href:t,...a})),p.map(({key:t,link:n})=>e.createElement("link",{key:t,...n})))}function De(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}be.displayName="FrameworkContext";var Ie="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Ie&&(window.__reactRouterVersion="7.0.1")}catch(e){}function xe({basename:t,children:n,window:r}){let o=e.useRef();null==o.current&&(o.current=function(e={}){return function(e,t,n,r={}){let{window:o=document.defaultView,v5Compat:s=!1}=r,u=o.history,f="POP",p=null,m=_();function _(){return(u.state||{idx:null}).idx}function h(){f="POP";let e=_(),t=null==e?null:e-m;m=e,p&&p({action:f,location:g.location,delta:t})}function b(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"==typeof e?e:l(e);return n=n.replace(/ $/,"%20"),i(t,`No window.location.(origin|href) available to create URL for href: ${n}`),new URL(n,t)}null==m&&(m=0,u.replaceState({...u.state,idx:m},""));let g={get action(){return f},get location(){return e(o,u)},listen(e){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(a,h),p=e,()=>{o.removeEventListener(a,h),p=null}},createHref:e=>t(o,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){f="PUSH";let a=d(g.location,e,t);n&&n(a,e),m=_()+1;let i=c(a,m),r=g.createHref(a);try{u.pushState(i,"",r)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;o.location.assign(r)}s&&p&&p({action:f,location:g.location,delta:1})},replace:function(e,t){f="REPLACE";let a=d(g.location,e,t);n&&n(a,e),m=_();let i=c(a,m),r=g.createHref(a);u.replaceState(i,"",r),s&&p&&p({action:f,location:g.location,delta:0})},go:e=>u.go(e)};return g}(function(e,t){let{pathname:n,search:a,hash:i}=e.location;return d("",{pathname:n,search:a,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:l(t)},null,e)}({window:r,v5Compat:!0}));let s=o.current,[u,f]=e.useState({action:s.action,location:s.location}),p=e.useCallback(t=>{e.startTransition(()=>f(t))},[f]);return e.useLayoutEffect(()=>s.listen(p),[s,p]),e.createElement(re,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:s})}var Ce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oe=e.forwardRef(function({onClick:t,discover:n="render",prefetch:a="none",relative:r,reloadDocument:o,replace:c,state:d,target:u,to:f,preventScrollReset:p,viewTransition:m,..._},h){let b,{basename:g}=e.useContext(N),v="string"==typeof f&&Ce.test(f),y=!1;if("string"==typeof f&&v&&(b=f,Ie))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=O(t.pathname,g);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:y=!0}catch(e){s(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let S=function(t,{relative:n}={}){i(z(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=e.useContext(N),{hash:o,pathname:s,search:c}=Q(t,{relative:n}),d=s;return"/"!==a&&(d="/"===s?a:L([a,s])),r.createHref({pathname:d,search:c,hash:o})}(f,{relative:r}),[D,I,x]=function(t,n){let a=e.useContext(be),[i,r]=e.useState(!1),[o,s]=e.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:l,onMouseLeave:u,onTouchStart:f}=n,p=e.useRef(null);e.useEffect(()=>{if("render"===t&&s(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(i){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[i]);let m=()=>{r(!0)},_=()=>{r(!1),s(!1)};return a?"intent"!==t?[o,p,{}]:[o,p,{onFocus:ve(c,m),onBlur:ve(d,_),onMouseEnter:ve(l,m),onMouseLeave:ve(u,_),onTouchStart:ve(f,m)}]:[!1,p,{}]}(a,_),C=function(t,{target:n,replace:a,state:i,preventScrollReset:r,relative:o,viewTransition:s}={}){let c=q(),d=G(),u=Q(t,{relative:o});return e.useCallback(e=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(e,n)){e.preventDefault();let n=void 0!==a?a:l(d)===l(u);c(t,{replace:n,state:i,preventScrollReset:r,relative:o,viewTransition:s})}},[d,c,u,a,i,n,t,r,o,s])}(f,{replace:c,state:d,target:u,preventScrollReset:p,relative:r,viewTransition:m}),w=e.createElement("a",{..._,...x,href:b||S,onClick:y||o?t:function(e){t&&t(e),e.defaultPrevented||C(e)},ref:De(h,I),target:u,"data-discover":v||"render"!==n?void 0:"true"});return D&&!v?e.createElement(e.Fragment,null,w,e.createElement(ye,{page:S})):w});Oe.displayName="Link",e.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:a="",end:r=!1,style:o,to:s,viewTransition:c,children:d,...l},u){let f=Q(s,{relative:l.relative}),p=G(),m=e.useContext(H),{navigator:_,basename:h}=e.useContext(N),b=null!=m&&function(t,n={}){let a=e.useContext(R);i(null!=a,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ee("useViewTransitionState"),o=Q(t,{relative:n.relative});if(!a.isTransitioning)return!1;let s=O(a.currentLocation.pathname,r)||a.currentLocation.pathname,c=O(a.nextLocation.pathname,r)||a.nextLocation.pathname;return null!=x(o.pathname,c)||null!=x(o.pathname,s)}(f)&&!0===c,g=_.encodeLocation?_.encodeLocation(f).pathname:f.pathname,v=p.pathname,y=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;n||(v=v.toLowerCase(),y=y?y.toLowerCase():null,g=g.toLowerCase()),y&&h&&(y=O(y,h)||y);const S="/"!==g&&g.endsWith("/")?g.length-1:g.length;let D,I=v===g||!r&&v.startsWith(g)&&"/"===v.charAt(S),C=null!=y&&(y===g||!r&&y.startsWith(g)&&"/"===y.charAt(g.length)),w={isActive:I,isPending:C,isTransitioning:b},E=I?t:void 0;D="function"==typeof a?a(w):[a,I?"active":null,C?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let A="function"==typeof o?o(w):o;return e.createElement(Oe,{...l,"aria-current":E,className:D,ref:u,style:A,to:s,viewTransition:c},"function"==typeof d?d(w):d)}).displayName="NavLink";var we=e.forwardRef(({discover:t="render",fetcherKey:n,navigate:a,reloadDocument:r,replace:o,state:s,method:c=ce,action:d,onSubmit:u,relative:f,preventScrollReset:p,viewTransition:m,..._},h)=>{let b=function(){let{router:t}=Ee("useSubmit"),{basename:n}=e.useContext(N),a=te("useRouteId");return e.useCallback(async(e,i={})=>{let{action:r,method:o,encType:s,formData:c,body:d}=function(e,t){let n,a,i,r,o;if(le(s=e)&&"form"===s.tagName.toLowerCase()){let o=e.getAttribute("action");a=o?O(o,t):null,n=e.getAttribute("method")||ce,i=pe(e.getAttribute("enctype"))||de,r=new FormData(e)}else if(function(e){return le(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return le(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||o.getAttribute("action");if(a=s?O(s,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||ce,i=pe(e.getAttribute("formenctype"))||pe(o.getAttribute("enctype"))||de,r=new FormData(o,e),!function(){if(null===ue)try{new FormData(document.createElement("form"),0),ue=!1}catch(e){ue=!0}return ue}()){let{name:t,type:n,value:a}=e;if("image"===n){let e=t?`${t}.`:"";r.append(`${e}x`,"0"),r.append(`${e}y`,"0")}else t&&r.append(t,a)}}else{if(le(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ce,a=null,i=de,o=e}var s;return r&&"text/plain"===i&&(o=r,r=void 0),{action:a,method:n.toLowerCase(),encType:i,formData:r,body:o}}(e,n);if(!1===i.navigate){let e=i.fetcherKey||Le();await t.fetch(e,a,i.action||r,{preventScrollReset:i.preventScrollReset,formData:c,body:d,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await t.navigate(i.action||r,{preventScrollReset:i.preventScrollReset,formData:c,body:d,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:a,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,n,a])}(),g=function(t,{relative:n}={}){let{basename:a}=e.useContext(N),r=e.useContext(j);i(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),s={...Q(t||".",{relative:n})},c=G();if(null==t){s.search=c.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?`?${n}`:""}}return t&&"."!==t||!o.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),"/"!==a&&(s.pathname="/"===s.pathname?a:L([a,s.pathname])),l(s)}(d,{relative:f}),v="get"===c.toLowerCase()?"get":"post",y="string"==typeof d&&Ce.test(d);return e.createElement("form",{ref:h,method:v,action:g,onSubmit:r?u:e=>{if(u&&u(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,i=t?.getAttribute("formmethod")||c;b(t||e.currentTarget,{fetcherKey:n,method:i,navigate:a,replace:o,state:s,relative:f,preventScrollReset:p,viewTransition:m})},..._,"data-discover":y||"render"!==t?void 0:"true"})});function Ee(t){let n=e.useContext(F);return i(n,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(t)),n}we.displayName="Form";var Ae=0,Le=()=>`__${String(++Ae)}__`;new TextEncoder;var ke=e=>"checkbox"===e.type,Me=e=>e instanceof Date,Pe=e=>null==e;const Te=e=>"object"==typeof e;var Ue=e=>!Pe(e)&&!Array.isArray(e)&&Te(e)&&!Me(e),Fe="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function He(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(Fe&&(e instanceof Blob||e instanceof FileList)||!n&&!Ue(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return Ue(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=He(e[n]));else t=e}return t}var Re=e=>Array.isArray(e)?e.filter(Boolean):[],Ne=e=>void 0===e,Be=(e,t,n)=>{if(!t||!Ue(e))return n;const a=Re(t.split(/[,[\].]+?/)).reduce((e,t)=>Pe(e)?e:e[t],e);return Ne(a)||a===e?Ne(e[t])?n:e[t]:a},je=e=>"boolean"==typeof e,Ve=e=>/^\w*$/.test(e),ze=e=>Re(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ge=(e,t,n)=>{let a=-1;const i=Ve(t)?[t]:ze(t),r=i.length,o=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==o){const n=e[t];r=Ue(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}if("__proto__"===t)return;e[t]=r,e=e[t]}return e};const Ke="onChange",We="onSubmit",qe="all",Qe="pattern",Ye="required";e.createContext(null);var Je=e=>Ue(e)&&!Object.keys(e).length,Xe=e=>Array.isArray(e)?e:[e],Ze=e=>"string"==typeof e,$e=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{},et=e=>({isOnSubmit:!e||e===We,isOnBlur:"onBlur"===e,isOnChange:e===Ke,isOnAll:e===qe,isOnTouch:"onTouched"===e}),tt=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));const nt=(e,t,n,a)=>{for(const i of n||Object.keys(e)){const n=Be(e,i);if(n){const{_f:e,...r}=n;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],i)&&!a)return!0;if(e.ref&&t(e.ref,e.name)&&!a)return!0;if(nt(r,t))break}else if(Ue(r)&&nt(r,t))break}}};var at=(e,t,n)=>{const a=Xe(Be(e,n));return Ge(a,"root",t[n]),Ge(e,n,a),e},it=e=>"file"===e.type,rt=e=>"function"==typeof e,ot=e=>{if(!Fe)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},st=e=>Ze(e),ct=e=>"radio"===e.type,dt=e=>e instanceof RegExp;const lt={value:!1,isValid:!1},ut={value:!0,isValid:!0};var ft=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Ne(e[0].attributes.value)?Ne(e[0].value)||""===e[0].value?ut:{value:e[0].value,isValid:!0}:ut:lt}return lt};const pt={isValid:!1,value:null};var mt=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,pt):pt;function _t(e,t,n="validate"){if(st(e)||Array.isArray(e)&&e.every(st)||je(e)&&!e)return{type:n,message:st(e)?e:"",ref:t}}var ht=e=>Ue(e)&&!dt(e)?e:{value:e,message:""},bt=async(e,t,n,a,i)=>{const{ref:r,refs:o,required:s,maxLength:c,minLength:d,min:l,max:u,pattern:f,validate:p,name:m,valueAsNumber:_,mount:h,disabled:b}=e._f,g=Be(t,m);if(!h||b)return{};const v=o?o[0]:r,y=e=>{a&&v.reportValidity&&(v.setCustomValidity(je(e)?"":e||""),v.reportValidity())},S={},D=ct(r),I=ke(r),x=D||I,C=(_||it(r))&&Ne(r.value)&&Ne(g)||ot(r)&&""===r.value||""===g||Array.isArray(g)&&!g.length,O=$e.bind(null,m,n,S),w=(e,t,n,a="maxLength",i="minLength")=>{const o=e?t:n;S[m]={type:e?a:i,message:o,ref:r,...O(e?a:i,o)}};if(i?!Array.isArray(g)||!g.length:s&&(!x&&(C||Pe(g))||je(g)&&!g||I&&!ft(o).isValid||D&&!mt(o).isValid)){const{value:e,message:t}=st(s)?{value:!!s,message:s}:ht(s);if(e&&(S[m]={type:Ye,message:t,ref:v,...O(Ye,t)},!n))return y(t),S}if(!(C||Pe(l)&&Pe(u))){let e,t;const a=ht(u),i=ht(l);if(Pe(g)||isNaN(g)){const n=r.valueAsDate||new Date(g),o=e=>new Date((new Date).toDateString()+" "+e),s="time"==r.type,c="week"==r.type;Ze(a.value)&&g&&(e=s?o(g)>o(a.value):c?g>a.value:n>new Date(a.value)),Ze(i.value)&&g&&(t=s?o(g)<o(i.value):c?g<i.value:n<new Date(i.value))}else{const n=r.valueAsNumber||(g?+g:g);Pe(a.value)||(e=n>a.value),Pe(i.value)||(t=n<i.value)}if((e||t)&&(w(!!e,a.message,i.message,"max","min"),!n))return y(S[m].message),S}if((c||d)&&!C&&(Ze(g)||i&&Array.isArray(g))){const e=ht(c),t=ht(d),a=!Pe(e.value)&&g.length>+e.value,i=!Pe(t.value)&&g.length<+t.value;if((a||i)&&(w(a,e.message,t.message),!n))return y(S[m].message),S}if(f&&!C&&Ze(g)){const{value:e,message:t}=ht(f);if(dt(e)&&!g.match(e)&&(S[m]={type:Qe,message:t,ref:r,...O(Qe,t)},!n))return y(t),S}if(p)if(rt(p)){const e=_t(await p(g,t),v);if(e&&(S[m]={...e,...O("validate",e.message)},!n))return y(e.message),S}else if(Ue(p)){let e={};for(const a in p){if(!Je(e)&&!n)break;const i=_t(await p[a](g,t),v,a);i&&(e={...i,...O(a,i.message)},y(i.message),n&&(S[m]=e))}if(!Je(e)&&(S[m]={ref:v,...e},!n))return S}return y(!0),S};function gt(e,t){const n=Array.isArray(t)?t:Ve(t)?[t]:ze(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=Ne(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,r=n[i];return a&&delete a[r],0!==i&&(Ue(a)&&Je(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!Ne(e[t]))return!1;return!0}(a))&&gt(e,n.slice(0,-1)),e}var vt=()=>{let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}},yt=e=>Pe(e)||!Te(e);function St(e,t){if(yt(e)||yt(t))return e===t;if(Me(e)&&Me(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(Me(n)&&Me(e)||Ue(n)&&Ue(e)||Array.isArray(n)&&Array.isArray(e)?!St(n,e):n!==e)return!1}}return!0}var Dt=e=>"select-multiple"===e.type,It=e=>ot(e)&&e.isConnected,xt=e=>{for(const t in e)if(rt(e[t]))return!0;return!1};function Ct(e,t={}){const n=Array.isArray(e);if(Ue(e)||n)for(const n in e)Array.isArray(e[n])||Ue(e[n])&&!xt(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Ct(e[n],t[n])):Pe(e[n])||(t[n]=!0);return t}function Ot(e,t,n){const a=Array.isArray(e);if(Ue(e)||a)for(const a in e)Array.isArray(e[a])||Ue(e[a])&&!xt(e[a])?Ne(t)||yt(n[a])?n[a]=Array.isArray(e[a])?Ct(e[a],[]):{...Ct(e[a])}:Ot(e[a],Pe(t)?{}:t[a],n[a]):n[a]=!St(e[a],t[a]);return n}var wt=(e,t)=>Ot(e,t,Ct(t)),Et=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>Ne(e)?e:t?""===e?NaN:e?+e:e:n&&Ze(e)?new Date(e):a?a(e):e;function At(e){const t=e.ref;if(!(e.refs?e.refs.every(e=>e.disabled):t.disabled))return it(t)?t.files:ct(t)?mt(e.refs).value:Dt(t)?[...t.selectedOptions].map(({value:e})=>e):ke(t)?ft(e.refs).value:Et(Ne(t.value)?e.ref.value:t.value,e)}var Lt=e=>Ne(e)?e:dt(e)?e.source:Ue(e)?dt(e.value)?e.value.source:e.value:e;const kt="AsyncFunction";function Mt(e,t,n){const a=Be(e,n);if(a||Ve(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=Be(t,a),o=Be(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(o&&o.type)return{name:a,error:o};i.pop()}return{name:n}}const Pt={mode:We,reValidateMode:Ke,shouldFocusError:!0};function Tt(e={}){let t,n={...Pt,...e},a={submitCount:0,isDirty:!1,isLoading:rt(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1},i={},r=(Ue(n.defaultValues)||Ue(n.values))&&He(n.defaultValues||n.values)||{},o=n.shouldUnregister?{}:He(r),s={action:!1,mount:!1,watch:!1},c={mount:new Set,unMount:new Set,array:new Set,watch:new Set},d=0;const l={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},u={values:vt(),array:vt(),state:vt()},f=et(n.mode),p=et(n.reValidateMode),m=n.criteriaMode===qe,_=async e=>{if(!n.disabled&&(l.isValid||e)){const e=n.resolver?Je((await v()).errors):await y(i,!0);e!==a.isValid&&u.state.next({isValid:e})}},h=(e,t)=>{n.disabled||!l.isValidating&&!l.validatingFields||((e||Array.from(c.mount)).forEach(e=>{e&&(t?Ge(a.validatingFields,e,t):gt(a.validatingFields,e))}),u.state.next({validatingFields:a.validatingFields,isValidating:!Je(a.validatingFields)}))},b=(e,t,n,a)=>{const c=Be(i,e);if(c){const i=Be(o,e,Ne(n)?Be(r,e):n);Ne(i)||a&&a.defaultChecked||t?Ge(o,e,t?i:At(c._f)):I(e,i),s.mount&&_()}},g=(e,t,o,s,c)=>{let d=!1,f=!1;const p={name:e};if(!n.disabled){const n=!!(Be(i,e)&&Be(i,e)._f&&Be(i,e)._f.disabled);if(!o||s){l.isDirty&&(f=a.isDirty,a.isDirty=p.isDirty=S(),d=f!==p.isDirty);const i=n||St(Be(r,e),t);f=!(n||!Be(a.dirtyFields,e)),i||n?gt(a.dirtyFields,e):Ge(a.dirtyFields,e,!0),p.dirtyFields=a.dirtyFields,d=d||l.dirtyFields&&f!==!i}if(o){const t=Be(a.touchedFields,e);t||(Ge(a.touchedFields,e,o),p.touchedFields=a.touchedFields,d=d||l.touchedFields&&t!==o)}d&&c&&u.state.next(p)}return d?p:{}},v=async e=>{h(e,!0);const t=await n.resolver(o,n.context,((e,t,n,a)=>{const i={};for(const n of e){const e=Be(t,n);e&&Ge(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||c.mount,i,n.criteriaMode,n.shouldUseNativeValidation));return h(e),t},y=async(e,t,i={valid:!0})=>{for(const s in e){const d=e[s];if(d){const{_f:e,...u}=d;if(e){const u=c.array.has(e.name),f=d._f&&!((r=d._f)&&r.validate||!(rt(r.validate)&&r.validate.constructor.name===kt||Ue(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===kt)));f&&l.validatingFields&&h([s],!0);const p=await bt(d,o,m,n.shouldUseNativeValidation&&!t,u);if(f&&l.validatingFields&&h([s]),p[e.name]&&(i.valid=!1,t))break;!t&&(Be(p,e.name)?u?at(a.errors,p,e.name):Ge(a.errors,e.name,p[e.name]):gt(a.errors,e.name))}!Je(u)&&await y(u,t,i)}}var r;return i.valid},S=(e,t)=>!n.disabled&&(e&&t&&Ge(o,e,t),!St(A(),r)),D=(e,t,n)=>((e,t,n,a,i)=>Ze(e)?(a&&t.watch.add(e),Be(n,e,i)):Array.isArray(e)?e.map(e=>(a&&t.watch.add(e),Be(n,e))):(a&&(t.watchAll=!0),n))(e,c,{...s.mount?o:Ne(t)?r:Ze(e)?{[e]:t}:t},n,t),I=(e,t,n={})=>{const a=Be(i,e);let r=t;if(a){const n=a._f;n&&(!n.disabled&&Ge(o,e,Et(t,n)),r=ot(n.ref)&&Pe(t)?"":t,Dt(n.ref)?[...n.ref.options].forEach(e=>e.selected=r.includes(e.value)):n.refs?ke(n.ref)?n.refs.length>1?n.refs.forEach(e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(r)?!!r.find(t=>t===e.value):r===e.value)):n.refs[0]&&(n.refs[0].checked=!!r):n.refs.forEach(e=>e.checked=e.value===r):it(n.ref)?n.ref.value="":(n.ref.value=r,n.ref.type||u.values.next({name:e,values:{...o}})))}(n.shouldDirty||n.shouldTouch)&&g(e,r,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&E(e)},x=(e,t,n)=>{for(const a in t){const r=t[a],o=`${e}.${a}`,s=Be(i,o);(c.array.has(e)||Ue(r)||s&&!s._f)&&!Me(r)?x(o,r,n):I(o,r,n)}},C=(e,t,n={})=>{const d=Be(i,e),f=c.array.has(e),p=He(t);Ge(o,e,p),f?(u.array.next({name:e,values:{...o}}),(l.isDirty||l.dirtyFields)&&n.shouldDirty&&u.state.next({name:e,dirtyFields:wt(r,o),isDirty:S(e,p)})):!d||d._f||Pe(p)?I(e,p,n):x(e,p,n),tt(e,c)&&u.state.next({...a}),u.values.next({name:s.mount?e:void 0,values:{...o}})},O=async r=>{s.mount=!0;const b=r.target;let S=b.name,D=!0;const I=Be(i,S),x=e=>{D=Number.isNaN(e)||Me(e)&&isNaN(e.getTime())||St(e,Be(o,S,e))};if(I){let s,O;const w=b.type?At(I._f):(e=>Ue(e)&&e.target?ke(e.target)?e.target.checked:e.target.value:e)(r),A="blur"===r.type||"focusout"===r.type,L=!((C=I._f).mount&&(C.required||C.min||C.max||C.maxLength||C.minLength||C.pattern||C.validate)||n.resolver||Be(a.errors,S)||I._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(A,Be(a.touchedFields,S),a.isSubmitted,p,f),k=tt(S,c,A);Ge(o,S,w),A?(I._f.onBlur&&I._f.onBlur(r),t&&t(0)):I._f.onChange&&I._f.onChange(r);const M=g(S,w,A,!1),P=!Je(M)||k;if(!A&&u.values.next({name:S,type:r.type,values:{...o}}),L)return l.isValid&&("onBlur"===e.mode?A&&_():_()),P&&u.state.next({name:S,...k?{}:M});if(!A&&k&&u.state.next({...a}),n.resolver){const{errors:e}=await v([S]);if(x(w),D){const t=Mt(a.errors,i,S),n=Mt(e,i,t.name||S);s=n.error,S=n.name,O=Je(e)}}else h([S],!0),s=(await bt(I,o,m,n.shouldUseNativeValidation))[S],h([S]),x(w),D&&(s?O=!1:l.isValid&&(O=await y(i,!0)));D&&(I._f.deps&&E(I._f.deps),((n,i,r,o)=>{const s=Be(a.errors,n),c=l.isValid&&je(i)&&a.isValid!==i;var f;if(e.delayError&&r?(f=()=>((e,t)=>{Ge(a.errors,e,t),u.state.next({errors:a.errors})})(n,r),t=e=>{clearTimeout(d),d=setTimeout(f,e)},t(e.delayError)):(clearTimeout(d),t=null,r?Ge(a.errors,n,r):gt(a.errors,n)),(r?!St(s,r):s)||!Je(o)||c){const e={...o,...c&&je(i)?{isValid:i}:{},errors:a.errors,name:n};a={...a,...e},u.state.next(e)}})(S,O,s,M))}var C},w=(e,t)=>{if(Be(a.errors,t)&&e.focus)return e.focus(),1},E=async(e,t={})=>{let r,o;const s=Xe(e);if(n.resolver){const t=await(async e=>{const{errors:t}=await v(e);if(e)for(const n of e){const e=Be(t,n);e?Ge(a.errors,n,e):gt(a.errors,n)}else a.errors=t;return t})(Ne(e)?e:s);r=Je(t),o=e?!s.some(e=>Be(t,e)):r}else e?(o=(await Promise.all(s.map(async e=>{const t=Be(i,e);return await y(t&&t._f?{[e]:t}:t)}))).every(Boolean),(o||a.isValid)&&_()):o=r=await y(i);return u.state.next({...!Ze(e)||l.isValid&&r!==a.isValid?{}:{name:e},...n.resolver||!e?{isValid:r}:{},errors:a.errors}),t.shouldFocus&&!o&&nt(i,w,e?s:c.mount),o},A=e=>{const t={...s.mount?o:r};return Ne(e)?t:Ze(e)?Be(t,e):e.map(e=>Be(t,e))},L=(e,t)=>({invalid:!!Be((t||a).errors,e),isDirty:!!Be((t||a).dirtyFields,e),error:Be((t||a).errors,e),isValidating:!!Be(a.validatingFields,e),isTouched:!!Be((t||a).touchedFields,e)}),k=(e,t,n)=>{const r=(Be(i,e,{_f:{}})._f||{}).ref,o=Be(a.errors,e)||{},{ref:s,message:c,type:d,...l}=o;Ge(a.errors,e,{...l,...t,ref:r}),u.state.next({name:e,errors:a.errors,isValid:!1}),n&&n.shouldFocus&&r&&r.focus&&r.focus()},M=(e,t={})=>{for(const s of e?Xe(e):c.mount)c.mount.delete(s),c.array.delete(s),t.keepValue||(gt(i,s),gt(o,s)),!t.keepError&&gt(a.errors,s),!t.keepDirty&&gt(a.dirtyFields,s),!t.keepTouched&&gt(a.touchedFields,s),!t.keepIsValidating&&gt(a.validatingFields,s),!n.shouldUnregister&&!t.keepDefaultValue&&gt(r,s);u.values.next({values:{...o}}),u.state.next({...a,...t.keepDirty?{isDirty:S()}:{}}),!t.keepIsValid&&_()},P=({disabled:e,name:t,field:n,fields:a,value:i})=>{if(je(e)&&s.mount||e){const r=e?void 0:Ne(i)?At(n?n._f:Be(a,t)._f):i;Ge(o,t,r),g(t,r,!1,!1,!0)}},T=(e,t={})=>{let a=Be(i,e);const o=je(t.disabled)||je(n.disabled);return Ge(i,e,{...a||{},_f:{...a&&a._f?a._f:{ref:{name:e}},name:e,mount:!0,...t}}),c.mount.add(e),a?P({field:a,disabled:je(t.disabled)?t.disabled:n.disabled,name:e,value:t.value}):b(e,!0,t.value),{...o?{disabled:t.disabled||n.disabled}:{},...n.progressive?{required:!!t.required,min:Lt(t.min),max:Lt(t.max),minLength:Lt(t.minLength),maxLength:Lt(t.maxLength),pattern:Lt(t.pattern)}:{},name:e,onChange:O,onBlur:O,ref:o=>{if(o){T(e,t),a=Be(i,e);const n=Ne(o.value)&&o.querySelectorAll&&o.querySelectorAll("input,select,textarea")[0]||o,s=(e=>ct(e)||ke(e))(n),c=a._f.refs||[];if(s?c.find(e=>e===n):n===a._f.ref)return;Ge(i,e,{_f:{...a._f,...s?{refs:[...c.filter(It),n,...Array.isArray(Be(r,e))?[{}]:[]],ref:{type:n.type,name:e}}:{ref:n}}}),b(e,!1,void 0,n)}else a=Be(i,e,{}),a._f&&(a._f.mount=!1),(n.shouldUnregister||t.shouldUnregister)&&(!((e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)))(c.array,e)||!s.action)&&c.unMount.add(e)}}},U=()=>n.shouldFocusError&&nt(i,w,c.mount),F=(e,t)=>async r=>{let s;if(r&&(r.preventDefault&&r.preventDefault(),r.persist&&r.persist()),n.disabled)return void(t&&await t({...a.errors},r));let c=He(o);if(u.state.next({isSubmitting:!0}),n.resolver){const{errors:e,values:t}=await v();a.errors=e,c=t}else await y(i);if(gt(a.errors,"root"),Je(a.errors)){u.state.next({errors:{}});try{await e(c,r)}catch(e){s=e}}else t&&await t({...a.errors},r),U(),setTimeout(U);if(u.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Je(a.errors)&&!s,submitCount:a.submitCount+1,errors:a.errors}),s)throw s},H=(t,n={})=>{const d=t?He(t):r,f=He(d),p=Je(t),m=p?r:f;if(n.keepDefaultValues||(r=d),!n.keepValues){if(n.keepDirtyValues){const e=new Set([...c.mount,...Object.keys(wt(r,o))]);for(const t of Array.from(e))Be(a.dirtyFields,t)?Ge(m,t,Be(o,t)):C(t,Be(m,t))}else{if(Fe&&Ne(t))for(const e of c.mount){const t=Be(i,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(ot(e)){const t=e.closest("form");if(t){t.reset();break}}}}i={}}o=e.shouldUnregister?n.keepDefaultValues?He(r):{}:He(m),u.array.next({values:{...m}}),u.values.next({values:{...m}})}c={mount:n.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},s.mount=!l.isValid||!!n.keepIsValid||!!n.keepDirtyValues,s.watch=!!e.shouldUnregister,u.state.next({submitCount:n.keepSubmitCount?a.submitCount:0,isDirty:!p&&(n.keepDirty?a.isDirty:!(!n.keepDefaultValues||St(t,r))),isSubmitted:!!n.keepIsSubmitted&&a.isSubmitted,dirtyFields:p?{}:n.keepDirtyValues?n.keepDefaultValues&&o?wt(r,o):a.dirtyFields:n.keepDefaultValues&&t?wt(r,t):n.keepDirty?a.dirtyFields:{},touchedFields:n.keepTouched?a.touchedFields:{},errors:n.keepErrors?a.errors:{},isSubmitSuccessful:!!n.keepIsSubmitSuccessful&&a.isSubmitSuccessful,isSubmitting:!1})},R=(e,t)=>H(rt(e)?e(o):e,t);return{control:{register:T,unregister:M,getFieldState:L,handleSubmit:F,setError:k,_executeSchema:v,_getWatch:D,_getDirty:S,_updateValid:_,_removeUnmounted:()=>{for(const e of c.unMount){const t=Be(i,e);t&&(t._f.refs?t._f.refs.every(e=>!It(e)):!It(t._f.ref))&&M(e)}c.unMount=new Set},_updateFieldArray:(e,t=[],c,d,f=!0,p=!0)=>{if(d&&c&&!n.disabled){if(s.action=!0,p&&Array.isArray(Be(i,e))){const t=c(Be(i,e),d.argA,d.argB);f&&Ge(i,e,t)}if(p&&Array.isArray(Be(a.errors,e))){const t=c(Be(a.errors,e),d.argA,d.argB);f&&Ge(a.errors,e,t),((e,t)=>{!Re(Be(e,t)).length&&gt(e,t)})(a.errors,e)}if(l.touchedFields&&p&&Array.isArray(Be(a.touchedFields,e))){const t=c(Be(a.touchedFields,e),d.argA,d.argB);f&&Ge(a.touchedFields,e,t)}l.dirtyFields&&(a.dirtyFields=wt(r,o)),u.state.next({name:e,isDirty:S(e,t),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else Ge(o,e,t)},_updateDisabledField:P,_getFieldArray:t=>Re(Be(s.mount?o:r,t,e.shouldUnregister?Be(r,t,[]):[])),_reset:H,_resetDefaultValues:()=>rt(n.defaultValues)&&n.defaultValues().then(e=>{R(e,n.resetOptions),u.state.next({isLoading:!1})}),_updateFormState:e=>{a={...a,...e}},_disableForm:e=>{je(e)&&(u.state.next({disabled:e}),nt(i,(t,n)=>{const a=Be(i,n);a&&(t.disabled=a._f.disabled||e,Array.isArray(a._f.refs)&&a._f.refs.forEach(t=>{t.disabled=a._f.disabled||e}))},0,!1))},_subjects:u,_proxyFormState:l,_setErrors:e=>{a.errors=e,u.state.next({errors:a.errors,isValid:!1})},get _fields(){return i},get _formValues(){return o},get _state(){return s},set _state(e){s=e},get _defaultValues(){return r},get _names(){return c},set _names(e){c=e},get _formState(){return a},set _formState(e){a=e},get _options(){return n},set _options(e){n={...n,...e}}},trigger:E,register:T,handleSubmit:F,watch:(e,t)=>rt(e)?u.values.subscribe({next:n=>e(D(void 0,t),n)}):D(e,t,!0),setValue:C,getValues:A,reset:R,resetField:(e,t={})=>{Be(i,e)&&(Ne(t.defaultValue)?C(e,He(Be(r,e))):(C(e,t.defaultValue),Ge(r,e,He(t.defaultValue))),t.keepTouched||gt(a.touchedFields,e),t.keepDirty||(gt(a.dirtyFields,e),a.isDirty=t.defaultValue?S(e,He(Be(r,e))):S()),t.keepError||(gt(a.errors,e),l.isValid&&_()),u.state.next({...a}))},clearErrors:e=>{e&&Xe(e).forEach(e=>gt(a.errors,e)),u.state.next({errors:e?a.errors:{}})},unregister:M,setError:k,setFocus:(e,t={})=>{const n=Be(i,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&rt(e.select)&&e.select())}},getFieldState:L}}function Ut(t={}){const n=e.useRef(),a=e.useRef(),[i,r]=e.useState({isDirty:!1,isValidating:!1,isLoading:rt(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:rt(t.defaultValues)?void 0:t.defaultValues});n.current||(n.current={...Tt(t),formState:i});const o=n.current.control;return o._options=t,function(t){const n=e.useRef(t);n.current=t,e.useEffect(()=>{const e=!t.disabled&&n.current.subject&&n.current.subject.subscribe({next:n.current.next});return()=>{e&&e.unsubscribe()}},[t.disabled])}({subject:o._subjects.state,next:e=>{((e,t,n)=>{n(e);const{name:a,...i}=e;return Je(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(e=>t[e]===qe)})(e,o._proxyFormState,o._updateFormState)&&r({...o._formState})}}),e.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),e.useEffect(()=>{if(o._proxyFormState.isDirty){const e=o._getDirty();e!==i.isDirty&&o._subjects.state.next({isDirty:e})}},[o,i.isDirty]),e.useEffect(()=>{t.values&&!St(t.values,a.current)?(o._reset(t.values,o._options.resetOptions),a.current=t.values,r(e=>({...e}))):o._resetDefaultValues()},[t.values,o]),e.useEffect(()=>{t.errors&&o._setErrors(t.errors)},[t.errors,o]),e.useEffect(()=>{o._state.mount||(o._updateValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),e.useEffect(()=>{t.shouldUnregister&&o._subjects.values.next({values:o._getWatch()})},[t.shouldUnregister,o]),n.current.formState=((e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==qe&&(t._proxyFormState[i]=!a||qe),n&&(n[i]=!0),e[i]}});return i})(i,o),n.current}var Ft="Programs",Ht="Interviews";function Rt(e,t,n){let a=new Date(e.toString());switch(t.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+n);break;case"quarter":a.setMonth(a.getMonth()+3*n);break;case"month":a.setMonth(a.getMonth()+n);break;case"week":a.setDate(a.getDate()+7*n);break;case"day":a.setDate(a.getDate()+n);break;case"hour":a.setTime(a.getTime()+36e5*n);break;case"minute":a.setTime(a.getTime()+6e4*n);break;case"second":a.setTime(a.getTime()+1e3*n);break;default:a=void 0}return a}function Nt(...e){return e.filter(e=>!Gt(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function Bt(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function jt(e){return"function"==typeof e}function Vt(e){return Array.isArray(e)}function zt(e){return/^https?:\/\/|^\/\//i.test(e)}function Gt(e){return null==e||e.length<1}function Kt(e){return null!=e}function Wt(e){return JSON.stringify(e)}function qt(e,t){return Object.hasOwnProperty.call(e,t)}let Qt;function Yt(){return void 0===Qt&&(Qt=new Xt),Qt}class Jt{constructor(e){this.store=e,this.enabled=this.test()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!Kt(t))return null;const n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}put(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}delete(e){this.enabled&&this.store.removeItem(e)}async getOrPut(e,t,n){if(!this.enabled)return t();let a=this.get(e);return null===a&&(a=await t(),this.put(e,a,n)),a}async deleteExpired(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&await this.get(t)}}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){return void 0===t&&(t=Rt(new Date,"minute",5)),Wt({pnp:1,expiration:t,value:e})}}class Xt{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}function Zt(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function $t(){return async function(e,...t){return[...e].reduce((e,t)=>e.then(e=>Reflect.apply(t,this,e)),Promise.resolve(t))}}function en(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t);return this}}const tn=Symbol.for("ObserverLifecycleFlags"),nn=e=>t=>!((t[tn]||0)&e),an=e=>t=>(t[tn]=(t[tn]||0)|e,t),rn=an(1);an(2);class on{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),sn(e.observers,t,n,1),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),sn(e.observers,t,n,3),e),prepend:n=>(e.cloneObserversOnChange(),sn(e.observers,t,n,2),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){Kt(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!Vt(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?en():Zt();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}finally{a&&a.length>0&&Reflect.set(e.observers,t,a.filter(nn(2)))}}})),this._emitProxy}start(e){this.emit.init();const t=this.execute(e);return t.finally(()=>{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}).catch(()=>{}),t}cloneObserversOnChange(){this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=cn(this.observers))}}function sn(e,t,n,a){if(!jt(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case 1:e[t].push(n);break;case 2:e[t].unshift(n);break;case 3:e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}function cn(e){return Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n].filter(nn(1))],t),{})}function dn(e){return t=>(t.observers=e.observers,t._inheritingObservers=!0,t)}function ln(e,t="append",n){return a=>Reflect.apply(un,a,[e,t,n])}function un(e,t,n){if(!Kt(e)||!Kt(e.observers))return this;jt(n)||(n=()=>!0);const a=cn(e.observers),i=Object.keys(a).filter(n);for(let e=0;e<i.length;e++){const n=i[e],r=this.on[n];"replace"===t&&r.clear(),a[n].forEach(e=>r(e))}return this}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const fn={construct:en(),pre:$t(),auth:$t(),send:async function(e,...t){if(!Vt(e)||e.length<1)return;const n=e[0];return Reflect.apply(n,this,t)},parse:$t(),post:$t(),data:Zt()};let pn=class extends on{constructor(e,t){let n;if(super(fn),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=function(e,...t){return[...e].reduce((e,t)=>Reflect.apply(t,this,e),t)},"string"==typeof e)this._url=Nt(e,t);else if(Vt(e)){if(2!==e.length)throw Error("When using the tuple param exactly two arguments are expected.");if("string"!=typeof e[1])throw Error("Expected second tuple param to be a string.");n=e[0],this._url=Nt(e[1],t)}else n=e,this._url=Nt(n._url,t);void 0!==n&&(this.observers=n.observers,this._inheritingObservers=!0)}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();const t=this.query.toString();return Gt(t)||(e+=`${e.indexOf("?")>-1?"&":"?"}${t}`),e}get query(){return this._query}toUrl(){return this._url}execute(e){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");return setTimeout(async()=>{const t=Bt();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",0);const i={...e,headers:{...e.headers,"X-PnPjs-RequestId":t}};let[r,o,s]=await this.emit.pre(this.toRequestUrl(),i,void 0);if(a(`Url: ${r}`,1),void 0!==s)return a("Result returned from pre, Emitting data"),this.emit.data(s),void a("Emitted data");a("Emitting auth"),[n,o]=await this.emit.auth(new URL(r),o),a("Emitted auth"),o={...o,...e,headers:{...o.headers,...e.headers}},a("Emitting send");let c=await this.emit.send(n,o);a("Emitted send"),a("Emitting parse"),[n,c,s]=await this.emit.parse(n,c,s),a("Emitted parse"),a("Emitting post"),[n,s]=await this.emit.post(n,s),a("Emitted post"),a("Emitting data"),this.emit.data(s),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",0)}},0),this.emit[this.InternalPromise](new Promise((e,t)=>{this.on[this.InternalResolve].replace(e),this.on[this.InternalReject].replace(t)}))[0]}};function mn(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function _n(e){return this.start(mn("GET",e))}function hn(e){return this.start(mn("POST",e))}function bn(e){return this.start(mn("PATCH",e))}function gn(e){return this.start(mn("DELETE",e))}function vn(e,t,n){return Reflect.apply(t,e,[n])}function yn(e){return t=>new Proxy(t,{construct(t,n,a){const i=Object.assign(function(t){return jt(e)||(e=function(e){return vn(this,_n,e)}),Reflect.apply(e,i,[t])},Reflect.construct(t,n,a));return Reflect.setPrototypeOf(i,a.prototype),i}})}function Sn(){return Cn(e=>e.text())}function Dn(){return Cn(e=>e.json())}async function In(e,t,n){if(!t.ok)throw await On.init(t);return[e,t,n]}function xn(e){let t=e;return qt(e,"d")?t=qt(e.d,"results")?e.d.results:e.d:qt(e,"value")&&(t=e.value),t}function Cn(e){return t=>(t.on.parse.replace(In),t.on.parse(async(t,n,a)=>(n.ok&&void 0===a&&(a=await e(n)),[t,n,a])),t)}pn=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([yn()],pn);class On extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.text();return new On(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e)}}new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new Jt("undefined"==typeof localStorage?Yt():localStorage)),this._local}get session(){return null===this._session&&(this._session=new Jt("undefined"==typeof sessionStorage?Yt():sessionStorage)),this._session}};const wn="__CancelMoment__",En=Symbol.for("CancelScopeId"),An=new Map;async function Ln(e){const t=An.get(e);t.controller.abort(),Vt(null==t?void 0:t.actions)&&t.actions.map(e=>t.currentSelf.on[wn](e));try{await t.currentSelf.emit[wn]()}catch(e){t.currentSelf.log(`Error in cancel: ${e}`,3)}}const kn=e=>function(...t){Reflect.has(this,En)||function(e){const t=Bt();e[En]=t,An.set(t,{cancel:Ln.bind({},t),actions:[],controller:null,currentSelf:e})}(this);const n=e.apply(this,t).finally(()=>{An.delete(this[En]),delete this[En]});return n.cancel=An.get(this[En]).cancel,n};function Mn(e,t,n){n.value=kn(n.value)}function Pn(e){return t=>(t.on.pre(async function(...t){const n=An.get(this[En]);return Kt(n)&&(Vt(n.actions)||(n.actions=[]),n.actions.indexOf(e)<0&&n.actions.push(e)),t}),t)}function Tn(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function Un(e,t){return Object.assign({body:Wt(e)},t)}function Fn(e,t){return Object.assign({},t,{headers:{...null==t?void 0:t.headers,...e}})}const Hn=e=>{return t=e,(e,n)=>{const a=new t(e,n);return a.emit.construct(e,n),a};var t};class Rn extends pn{constructor(e,t){if("string"==typeof e){let n="",a="";if(zt(e)||e.lastIndexOf("/")<0)a=e,n=Nt(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const i=e.lastIndexOf("/");a=e.slice(0,i),t=Nt(e.slice(i),t),n=Nt(a,t)}else{const i=e.lastIndexOf("(");a=e.slice(0,i),n=Nt(e,t)}super(n),this.parentUrl=a}else{super(e,t);const n=Vt(e)?e[0]:e;this.parentUrl=Vt(e)?e[1]:n.toUrl()}}toRequestUrl(){const e=new URLSearchParams(this.query);let t=this.toUrl().replace(/'!(@.+?)::((?:[^']|'')+)'/gi,(t,n,a)=>(this.log(`Rewriting aliased parameter from match ${t} to label: ${n} value: ${a}`,0),e.set(n,`'${a}'`),n));const n=e.toString();return Gt(n)||(t+=`${t.indexOf("?")>-1?"&":"?"}${n}`),t}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t,n=this.parentUrl){return e([this,n],t)}}const Nn=Hn(Rn);class Bn extends Rn{filter(e){return"object"==typeof e?(this.query.set("$filter",e.toString()),this):"function"==typeof e?(this.query.set("$filter",e(ea.Where()).toString()),this):(this.query.set("$filter",e.toString()),this)}orderBy(e,t=!0){const n="$orderby",a=this.query.has(n)?this.query.get(n).split(","):[];return a.push(`${e} ${t?"asc":"desc"}`),this.query.set(n,a.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const jn=Hn(Bn);class Vn extends Rn{}const zn=Hn(Vn);function Gn(){return function(){return Qn(this)}}function Kn(){return function(e="*"){return Yn(this,{},e)}}const Wn=(e,t)=>vn(e,hn,t),qn=(e,t)=>((t=t||{}).headers={...t.headers,"X-HTTP-Method":"MERGE"},Wn(e,t)),Qn=(e,t)=>((t=t||{}).headers={...t.headers||{},"X-HTTP-Method":"DELETE"},Wn(e,t)),Yn=(e,t,n="*")=>((t=t||{}).headers={...t.headers||{},"IF-Match":n},Qn(e,t)),Jn=(e,t)=>vn(e,gn,t),Xn=(e,t)=>vn(e,bn,t);var Zn,$n;!function(e){e.Equals="eq",e.NotEquals="ne",e.GreaterThan="gt",e.GreaterThanOrEqualTo="ge",e.LessThan="lt",e.LessThanOrEqualTo="le",e.StartsWith="startswith",e.SubstringOf="substringof"}(Zn||(Zn={})),function(e){e.And="and",e.AndWithSpace=" and ",e.Or="or",e.OrWithSpace=" or "}($n||($n={}));class ea{static Where(){return new ra([])}}class ta{constructor(e){this.query=[],this.query=e}}class na extends ta{constructor(e){super(e)}text(e){return new da([...this.query,e])}choice(e){return new da([...this.query,e])}multiChoice(e){return new da([...this.query,e])}number(e){return new fa([...this.query,e])}date(e){return new pa([...this.query,e])}boolean(e){return new la([...this.query,e])}lookup(e){return new oa([...this.query],e)}lookupId(e){const t=e.endsWith("Id")?e:`${e}Id`;return new fa([...this.query,t])}}class aa extends na{or(...e){return new ma([...this.query,`(${e.map(e=>e.toString()).join($n.OrWithSpace)})`])}}class ia extends na{and(...e){return new ma([...this.query,`(${e.map(e=>e.toString()).join($n.AndWithSpace)})`])}}class ra extends na{or(...e){return null==e||0===e.length?new na([...this.query,$n.Or]):new ma([...this.query,`(${e.map(e=>e.toString()).join($n.OrWithSpace)})`])}and(...e){return null==e||0===e.length?new na([...this.query,$n.And]):new ma([...this.query,`(${e.map(e=>e.toString()).join($n.AndWithSpace)})`])}}class oa extends ta{constructor(e,t){super(e),this.LookupField=t}Id(e){return new ma([...this.query,`${this.LookupField}/Id`,Zn.Equals,e.toString()])}text(e){return new da([...this.query,`${this.LookupField}/${e}`])}number(e){return new fa([...this.query,`${this.LookupField}/${e}`])}}class sa extends ta{constructor(e){super(e),this.LastIndex=e.length-1,this.InternalName=e[this.LastIndex]}toODataValue(e){return`'${e}'`}isNull(){return new ma([...this.query,Zn.Equals,"null"])}isNotNull(){return new ma([...this.query,Zn.NotEquals,"null"])}}class ca extends sa{equals(e){return new ma([...this.query,Zn.Equals,this.toODataValue(e)])}notEquals(e){return new ma([...this.query,Zn.NotEquals,this.toODataValue(e)])}in(...e){return ea.Where().or(...e.map(e=>this.equals(e)))}notIn(...e){return ea.Where().and(...e.map(e=>this.notEquals(e)))}}class da extends ca{startsWith(e){const t=`${Zn.StartsWith}(${this.InternalName}, ${this.toODataValue(e)})`;return this.query[this.LastIndex]=t,new ma([...this.query])}contains(e){const t=`${Zn.SubstringOf}(${this.toODataValue(e)}, ${this.InternalName})`;return this.query[this.LastIndex]=t,new ma([...this.query])}}class la extends sa{toODataValue(e){return`${null==e?"null":e?1:0}`}isTrue(){return new ma([...this.query,Zn.Equals,this.toODataValue(!0)])}isFalse(){return new ma([...this.query,Zn.Equals,this.toODataValue(!1)])}isFalseOrNull(){const e=`(${[this.InternalName,Zn.Equals,this.toODataValue(null),$n.Or,this.InternalName,Zn.Equals,this.toODataValue(!1)].join(" ")})`;return this.query[this.LastIndex]=e,new ma([...this.query])}}class ua extends ca{greaterThan(e){return new ma([...this.query,Zn.GreaterThan,this.toODataValue(e)])}greaterThanOrEquals(e){return new ma([...this.query,Zn.GreaterThanOrEqualTo,this.toODataValue(e)])}lessThan(e){return new ma([...this.query,Zn.LessThan,this.toODataValue(e)])}lessThanOrEquals(e){return new ma([...this.query,Zn.LessThanOrEqualTo,this.toODataValue(e)])}}class fa extends ua{toODataValue(e){return`${e}`}}class pa extends ua{toODataValue(e){return`'${e.toISOString()}'`}isBetween(e,t){const n=`(${[this.InternalName,Zn.GreaterThan,this.toODataValue(e),$n.And,this.InternalName,Zn.LessThan,this.toODataValue(t)].join(" ")})`;return this.query[this.LastIndex]=n,new ma([...this.query])}isToday(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;return t.setHours(23,59,59,999),this.isBetween(e,t)}}class ma extends ta{and(...e){return null==e||0===e.length?new aa([...this.query,$n.And]):new ma([...this.query,$n.And,`(${e.map(e=>e.toString()).join($n.AndWithSpace)})`])}or(...e){return null==e||0===e.length?new ia([...this.query,$n.Or]):new ma([...this.query,$n.Or,`(${e.map(e=>e.toString()).join($n.OrWithSpace)})`])}toString(){return this.query.join(" ")}}class _a{constructor(e=""){this._root=Nn(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}function ha(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new _a(e)}function ba(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function ga(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function va(e){if(Gt(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substring(0,t):e}function ya(e){return Gt(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${n.replace(/'/gi,"''")}`):encodeURIComponent(e.replace(/'/gi,"''"))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let Sa=class extends Bn{async add(e,t,n="",a="STS",i=1033,r=!0){const o=Un({parameters:{Description:n,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:r,WebTemplate:a}});return Wn(Da(this,"add"),o)}};Sa=ba([ga("webs")],Sa);const Da=Hn(Sa);function Ia(e,t){let n="_api/web";const a=/(_api[/|\\](site\/rootweb|site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=va(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=Nt(e,n)),e}let xa=class extends Vn{constructor(e,t){super(e="string"==typeof e?Ia(e,t):Vt(e)?[e[0],Ia(e[1],t)]:[e,Ia(e.toUrl(),t)],t),this.delete=Gn()}get webs(){return Da(this)}get allProperties(){return zn(this,"allproperties")}get webinfos(){return jn(this,"webinfos")}async getParentWeb(){const{Url:e,ParentWeb:t}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return(null==t?void 0:t.ServerRelativeUrl)?Ca([this,Nt(new URL(e).origin,t.ServerRelativeUrl)]):null}async update(e){return qn(this,Un(e))}applyTheme(e,t,n,a){const i=Un({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:a});return Wn(Ca(this,"applytheme"),i)}applyWebTemplate(e){return Wn(Ca(this,`applywebtemplate(webTemplate='${ya(e)}')`))}getChanges(e){return Wn(Ca(this,"getchanges"),Un({query:e}))}mapToIcon(e,t=0,n=""){return Ca(this,`maptoicon(filename='${ya(e)}',progid='${ya(n)}',size=${t})`)()}getStorageEntity(e){return Ca(this,`getStorageEntity('${ya(e)}')`)()}setStorageEntity(e,t,n="",a=""){return Wn(Ca(this,"setStorageEntity"),Un({comments:a,description:n,key:e,value:t}))}removeStorageEntity(e){return Wn(Ca(this,`removeStorageEntity('${ya(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return jn(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}availableWebTemplates(e=1033,t=!0){return jn(this,`getavailablewebtemplates(lcid=${e},doincludecrosslanguage=${t})`)}};xa=ba([ga("_api/web")],xa);const Ca=Hn(xa);function Oa(e,t){const n=["_api/web/tenantappcatalog/","_api/web/sitecollectionappcatalog/"];for(let a=0;a<n.length;a++){const i=e.indexOf(n[a]);if(i>-1)return Nt(e.substring(i,i+n[a].length),t)}return Nt(e,t)}let wa=class extends Bn{constructor(e,t){super(e,null),this._url=Nt(va(this._url),t)}getAppById(e){return Aa(this,`getById('${e}')`)}async syncSolutionToTeams(e,t=!1){let n=null;const a=Nt(va(this.toUrl()),"_api/web");if(t)n=e;else{const t=(await jn([this,a],"lists").select("Id").filter("EntityTypeName eq 'AppCatalog'")())[0].Id,i=await jn([this,a],`lists/getById('${t}')/items`).select("Id").filter(`AppProductID eq '${e}'`).top(1)();if(!(i&&i.length>0))throw Error(`Did not find the app with id ${e} in the appcatalog.`);n=i[0].Id}return Wn(Ea(this,Oa(this.toUrl(),`SyncSolutionToTeams(id=${n})`)))}async add(e,t,n=!0){const a=Ea(this,Oa(this.toUrl(),`add(overwrite=${n},url='${e}')`));return Wn(a,{body:t,headers:{binaryStringRequestBody:"true"}})}};wa=ba([ga("_api/web/tenantappcatalog/AvailableApps")],wa);const Ea=Hn(wa),Aa=Hn(class extends Vn{deploy(e=!1){return this.do(`Deploy(${e})`)}retract(){return this.do("Retract")}install(){return this.do("Install")}uninstall(){return this.do("Uninstall")}upgrade(){return this.do("Upgrade")}remove(){return this.do("Remove")}do(e){return Wn(Aa(this,e))}});Tn(xa,"appcatalog",e=>Ea(e,"_api/web/sitecollectionappcatalog/AvailableApps")),Reflect.defineProperty(_a.prototype,"tenantAppcatalog",{configurable:!0,enumerable:!0,get:function(){return this.create(Ea,"_api/web/tenantappcatalog/AvailableApps")}}),_a.prototype.getTenantAppCatalogWeb=async function(){const e=await Ca(this._root,"_api/SP_TenantSettings_Current")();return Ca([this._root,e.CorporateCatalogUrl])};const La="00000000-0000-0000-0000-000000000000";var ka,Ma,Pa;function Ta(e){const t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(qt(e,n[0])&&"SP.Web"===e[n[0]])qt(e,n[4])?t.push(e[n[4]]):qt(e,n[2])&&t.push(e.__metadata.uri);else if(qt(e,n[3])&&qt(e,n[1])){const a=zt(e[n[1]])?e[n[1]].split("_api")[1]:e[n[1]];t.push(va(e[n[3]]),"_api",a)}else qt(e,n[1])?t.push("_api",e[n[1]]):qt(e,n[2])&&t.push(e.__metadata.uri);return t.length<1?"":Nt(...t)}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(ka||(ka={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(Ma||(Ma={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(Pa||(Pa={})),_a.prototype.batched=function(e){const t=ha(this),[n,a]=Ra(t._root,e);return t.using(n),[t,a]},xa.prototype.batched=function(e){const t=Ca(this),[n,a]=Ra(t,e);return t.using(n),[t,a]};const Ua=Symbol.for("batch_registration"),Fa=Symbol.for("batch_request");class Ha extends Rn{constructor(e,t=e.toUrl().replace(/_api[\\|/].*$/i,"")){super(t,"_api/$batch"),this.requestBaseUrl=t,this.using(ln(e,"replace"),Cn(async e=>function(e){const t=[],n="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let r,o,s="batch",c={};const d=[];for(let e=0;e<i.length;++e){let l=i[e];switch(s){case"batch":if(l.substring(0,16)===n)s="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(s="status");break;case"status":{const t=a.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);r=parseInt(t[1],10),o=t[2],s="statusHeaders";break}case"statusHeaders":if(""===l.trim())s="body";else{const e=l.split(":");2===(null==e?void 0:e.length)&&(c[e[0].trim()]=e[1].trim())}break;case"body":for(d.length=0;l.substring(0,16)!==n;)d.push(l),l=i[++e];e--,t.push(new Response(204===r?null:d.join(""),{status:r,statusText:o,headers:c})),s="batch",c={}}}if("status"!==s)throw Error("Unexpected end of input");return t}(await e.text()))),this.on.dispose(()=>{e.using(ln(this,"replace",e=>/(auth|send|pre|init)/i.test(e)))})}}function Ra(e,t){const n=[],a=[],i=[],r=Bt(),o=new Ha(e),s=new Ha(e),{headersCopyPattern:c}={headersCopyPattern:/Accept|Content-Type|IF-Match/i,...t};return[e=>(e.on.init(function(){if(jt(this[Ua]))throw Error("This instance is already part of a batch. Please review the docs at https://pnp.github.io/pnpjs/concepts/batching#reuse.");return n.push(new Promise(e=>{this[Ua]=e})),this}),e.on.pre(async function(e,t,n){return qt(t.headers,"X-PnP-BatchNever")?("function"==typeof this[Fa]&&(this[Fa](),delete this[Fa]),this.using(ln(s,"replace",e=>/(init|pre)/i.test(e))),[e,t,n]):(this.on.auth.clear(),this.on.send.replace(async function(e,t){const n=new Promise((n,a)=>{i.push([this,e.toString(),t,n,a])});return this.log(`[batch:${r}] (${(new Date).getTime()}) Adding request ${t.method} ${e.toString()} to batch.`,0),a.push(new Promise(e=>{this[Fa]=e})),this[Ua](),n}),this.on.dispose(function(){jt(this[Ua])&&(this[Ua](),delete this[Ua]),jt(this[Fa])&&(this[Fa](),delete this[Fa],this.using(ln(s,"replace",e=>/(auth|pre|send|init|dispose)/i.test(e))))}),[e,t,n])}),e),async()=>{if(await Promise.all(n),i.length<1)return Promise.all(a).then(()=>{});const e=[];let t="";for(let n=0;n<i.length;n++){const[,a,s]=i[n];"GET"===s.method?(t.length>0&&(e.push(`--changeset_${t}--\n\n`),t=""),e.push(`--batch_${r}\n`)):(t.length<1&&(t=Bt(),e.push(`--batch_${r}\n`),e.push(`Content-Type: multipart/mixed; boundary="changeset_${t}"\n\n`)),e.push(`--changeset_${t}\n`)),e.push("Content-Type: application/http\n"),e.push("Content-Transfer-Encoding: binary\n\n");const d=new Headers(s.headers),l=zt(a)?a:Nt(o.requestBaseUrl,a);if("GET"!==s.method){let t=s.method;d.has("X-HTTP-Method")&&(t=d.get("X-HTTP-Method"),d.delete("X-HTTP-Method")),e.push(`${t} ${l} HTTP/1.1\n`)}else e.push(`${s.method} ${l} HTTP/1.1\n`);d.has("Accept")||d.append("Accept","application/json"),d.has("Content-Type")||d.append("Content-Type","application/json;charset=utf-8"),d.forEach((t,n)=>{c.test(n)&&e.push(`${n}: ${t}\n`)}),e.push("\n"),s.body&&e.push(`${s.body}\n\n`)}t.length>0&&(e.push(`--changeset_${t}--\n\n`),t=""),e.push(`--batch_${r}--\n`);const s=await Wn(o,{body:e.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${r}`}});if(s.length!==i.length)throw Error("Could not properly parse responses to match requests in batch.");return new Promise((e,t)=>{try{for(let e=0;e<s.length;e++){const[,,,t,n]=i[e];try{t(s[e])}catch(e){n(e)}}setTimeout(e,0)}catch(e){setTimeout(()=>t(e),0)}}).then(()=>Promise.all(a)).then(()=>{})}]}function Na(e){const t=new Date;return!Kt(e)||t>e.expiration?null:e}const Ba=new Map;class ja extends Error{constructor(e){super(`SPFx Context supplied to ${e} Behavior is null or undefined.`)}static check(e,t){if(null==t)throw new ja(e)}}function Va(e){return{DecodedUrl:e}}let za=class extends Bn{getById(e){return Wa(this).concat(`('${e}')`)}getByTitle(e){return Wa(this,`getByTitle('${ya(e)}')`)}async add(e,t="",n=100,a=!1,i={}){const r={AllowContentTypes:a,BaseTemplate:n,ContentTypesEnabled:a,Description:t,Title:e,...i};return Wn(this,Un(r))}async ensure(e,t="",n=100,a=!1,i={}){const r={Title:e,Description:t,ContentTypesEnabled:a,...i},o=this.getByTitle(r.Title);try{return await o.select("Title")(),{created:!1,data:await o.update(r),list:this.getByTitle(r.Title)}}catch(i){return{created:!0,data:await this.add(e,t,n,a,r),list:this.getByTitle(r.Title)}}}async ensureSiteAssetsLibrary(){const e=await Wn(Ga(this,"ensuresiteassetslibrary"));return Wa([this,Ta(e)])}async ensureSitePagesLibrary(){const e=await Wn(Ga(this,"ensuresitepageslibrary"));return Wa([this,Ta(e)])}};za=ba([ga("lists")],za);const Ga=Hn(za);class Ka extends Vn{constructor(){super(...arguments),this.delete=Kn()}get effectiveBasePermissions(){return Nn(this,"EffectiveBasePermissions")}get eventReceivers(){return jn(this,"EventReceivers")}get relatedFields(){return Nn(this,"getRelatedFields")}get informationRightsManagementSettings(){return Nn(this,"InformationRightsManagementSettings")}async update(e,t="*"){return await qn(this,Un(e,Fn({"IF-Match":t})))}getChanges(e){return Wn(Wa(this,"getchanges"),Un({query:e}))}getItemsByCAMLQuery(e,...t){return Wn(Wa(this,"getitems").expand(...t),Un({query:e}))}getListItemChangesSinceToken(e){return Wn(Wa(this,"getlistitemchangessincetoken").using(Sn()),Un({query:e}))}async recycle(){return Wn(Wa(this,"recycle"))}async renderListData(e){const t=Wa(this,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const n=await Wn(t);return JSON.parse(n)}renderListDataAsStream(e,t=null,n=new Map){qt(e,"RenderOptions")&&Vt(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));const a=Wa(this,"RenderListDataAsStream");n&&n.size>0&&n.forEach((e,t)=>a.query.set(t,e));const i=Kt(t)?{parameters:e,overrideParameters:t}:{parameters:e};return Wn(a,Un(i))}async renderListFormData(e,t,n){const a=await Wn(Wa(this,`renderlistformdata(itemid=${e}, formid='${t}', mode='${n}')`));return JSON.parse(a)}async reserveListItemId(){return Wn(Wa(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(e,t,n=!1,a,i){const r={FolderPath:Va(t)};return Kt(i)&&(i.leafName&&(r.LeafName=Va(i.leafName)),i.objectType&&(r.UnderlyingObjectType=i.objectType)),Wn(Wa(this,"AddValidateUpdateItemUsingPath()"),Un({bNewDocumentUpdate:n,checkInComment:a,formValues:e,listItemCreateInfo:r}))}async getParentInfos(){const e=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}}const Wa=Hn(Ka);var qa,Qa;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest",e[e.ListAvailableContentTypes=65536]="ListAvailableContentTypes",e[e.FolderContentTypeOrder=131072]="FolderContentTypeOrder",e[e.GridInitInfo=262144]="GridInitInfo",e[e.SiteUrlAsMediaTASPItemHost=524288]="SiteUrlAsMediaTASPItemHost",e[e.AddToOneDrive=1048576]="AddToOneDrive",e[e.SPFXCustomActions=2097152]="SPFXCustomActions",e[e.CustomActions=4194304]="CustomActions"}(qa||(qa={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(Qa||(Qa={}));let Ya=class extends Bn{getById(e){return Za(this).concat(`(${e})`)}getItemByStringId(e){return Za([this,this.parentUrl],`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`):this.query.set("$skiptoken",`Paged=TRUE&p_ID=${e}`),this}[Symbol.asyncIterator](){const e=jn(this).using(Cn(async e=>{const t=await e.json(),n=qt(t,"d")&&qt(t.d,"__next")?t.d.__next:t["odata.nextLink"];return{hasNext:"string"==typeof n&&n.length>0,nextLink:n,value:xn(t)}})),t=["$top","$select","$expand","$filter","$orderby","$skiptoken"];for(let n=0;n<t.length;n++){const a=this.query.get(t[n]);Kt(a)&&e.query.set(t[n],a)}return{_next:e,async next(){if(null===this._next)return{done:!0,value:void 0};const e=await this._next();return e.hasNext?(this._next=jn([this._next,e.nextLink]),{done:!1,value:e.value}):(this._next=null,{done:!1,value:e.value})}}}async add(e={}){return Wn(this,Un(e))}};Ya=ba([ga("items")],Ya);const Ja=Hn(Ya);class Xa extends Vn{constructor(){super(...arguments),this.delete=Kn()}get effectiveBasePermissions(){return Nn(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return Nn(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return zn(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return zn(this,"FieldValuesAsText")}get fieldValuesForEdit(){return zn(this,"FieldValuesForEdit")}get versions(){return ei(this)}get list(){return this.getParent(Wa,"",this.parentUrl.substring(0,this.parentUrl.lastIndexOf("/")))}async update(e,t="*"){const n=Un(e,Fn({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return Wn(Za(this).using(Cn(async e=>({etag:e.headers.get("etag")}))),n)}recycle(){return Wn(Za(this,"recycle"))}async deleteWithParams(e){return Wn(Za(this,"DeleteWithParameters"),Un({parameters:e}))}async getWopiFrameUrl(e=0){const t=Za(this,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),Wn(t)}validateUpdateListItem(e,t=!1){return Wn(Za(this,"validateupdatelistitem"),Un({formValues:e,bNewDocumentUpdate:t}))}async getParentInfos(){const e=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,Title:e.ParentList.Title,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}async setImageField(e,t,n){const a=await this.getParentInfos(),i=va(this.toUrl()),r=Nn([this,i],"/_api/web/UploadImage");r.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),r.query.set("@a1",`'${a.ParentList.Title}'`),r.query.set("@a2",`'${t}'`),r.query.set("@a3",`'${a.ParentList.Id}'`),r.query.set("@a4",a.Item.Id);const o=await Wn(r,{body:n}),s={type:"thumbnail",fileName:o.Name,nativeFile:{},fieldName:e,serverUrl:a.ParentWeb.Url.replace(a.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:o.ServerRelativeUrl,id:o.UniqueId};return this.validateUpdateListItem([{FieldName:e,FieldValue:JSON.stringify(s)}])}}const Za=Hn(Xa);let $a=class extends Bn{getById(e){return ti(this).concat(`(${e})`)}};$a=ba([ga("versions")],$a);const ei=Hn($a),ti=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Kn()}});class ni extends Vn{getText(){return this.getParsed(Sn())}getBlob(){return this.getParsed(Cn(e=>e.blob()))}getBuffer(){return this.getParsed(Cn(e=>jt(e.arrayBuffer)?e.arrayBuffer():e.buffer()))}getJSON(){return this.getParsed(Dn())}getStream(){return Nn(this,"$value").using(Cn(async e=>{var t;return{body:e.body,knownLength:parseInt((null===(t=null==e?void 0:e.headers)||void 0===t?void 0:t.get("content-length"))||"-1",10)}}),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheNever":"1"},[e,t,n]}),e))(Fn({binaryStringResponseBody:"true"}))}getParsed(e){return Nn(this,"$value").using(e,e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheNever":"1"},[e,t,n]}),e))()}}let ai=class extends Bn{getByName(e){const t=ri(this);return t.concat(`('${ya(e)}')`),t}async add(e,t){return{data:await Wn(ii(this,`add(FileName='${ya(e)}')`),{body:t}),file:this.getByName(e)}}};ai=ba([ga("AttachmentFiles")],ai);const ii=Hn(ai),ri=Hn(class extends ni{constructor(){super(...arguments),this.delete=Kn()}async setContent(e){return await Wn(ri(this,"$value"),Fn({"X-HTTP-Method":"PUT"},{body:e})),this}recycle(e="*"){return Wn(ri(this,"recycleObject"),Fn({"IF-Match":e,"X-HTTP-Method":"DELETE"}))}});function oi(e,t){let n="_api/site";const a=/(_api[/|\\](site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=va(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=Nt(e,n)),e}Tn(Xa,"attachmentFiles",ii);let si=class extends Vn{constructor(e,t){super(e="string"==typeof e?oi(e,t):Vt(e)?[e[0],oi(e[1],t)]:[e,oi(e.toUrl(),t)],t)}get rootWeb(){return Ca(this,"rootweb")}getChanges(e){const t=Un({query:e});return Wn(Ca(this,"getchanges"),t)}async openWebById(e){const t=await Wn(ci(this,`openWebById('${e}')`));return{data:t,web:Ca([this,va(Ta(t))])}}async getRootWeb(){const e=await this.rootWeb.select("Url")();return Ca([this,e.Url])}async delete(){const e=await ci(this,"").select("Id")(),t=ci([this,this.parentUrl],"_api/SPSiteManager/Delete");await Wn(t,Un({siteId:e.Id}))}async getDocumentLibraries(e){const t=ci([this,this.parentUrl],"_api/sp.web.getdocumentlibraries(@v)");t.query.set("@v",`'${e}'`);const n=await t();return qt(n,"GetDocumentLibraries")?n.GetDocumentLibraries:n}async getWebUrlFromPageUrl(e){const t=ci([this,this.parentUrl],"_api/sp.web.getweburlfrompageurl(@v)");t.query.set("@v",`'${e}'`);const n=await t();return qt(n,"GetWebUrlFromPageUrl")?n.GetWebUrlFromPageUrl:n}async createCommunicationSite(e,t=1033,n=!1,a,i,r,o,s,c){return this.createCommunicationSiteFromProps({Classification:r,Description:i,HubSiteId:s,Lcid:t,Owner:c,ShareByEmailEnabled:n,SiteDesignId:o,Title:e,Url:a})}async createCommunicationSiteFromProps(e){const t={Classification:"",Description:"",HubSiteId:La,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:La,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:La,...e};return Wn(ci([this,va(this.toUrl())],"/_api/SPSiteManager/Create"),Un({request:t}))}async exists(e){return Wn(ci([this,va(this.toUrl())],"/_api/SP.Site.Exists"),Un({url:e}))}async createModernTeamSite(e,t,n,a,i,r,o,s,c){return this.createModernTeamSiteFromProps({alias:t,classification:r,description:i,displayName:e,hubSiteId:s,isPublic:n,lcid:a,owners:o,siteDesignId:c})}async createModernTeamSiteFromProps(e){const t=Object.assign({},{classification:"",description:"",hubSiteId:La,isPublic:!0,lcid:1033,owners:[]},e),n={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:[`SPSiteLanguage:${t.lcid}`,`HubSiteId:${t.hubSiteId}`],Description:t.description,Owners:t.owners}};return t.siteDesignId&&n.optionalParams.CreationOptions.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${t.siteDesignId}`),Wn(ci([this,va(this.toUrl())],"/_api/GroupSiteManager/CreateGroupEx").using(Sn()),Un(n))}update(e){return Xn(this,Un(e))}setSiteLogo(e){return Wn(Nn([this,va(this.toUrl())],"_api/siteiconmanager/setsitelogo"),Un(e))}};si=ba([ga("_api/site")],si);const ci=Hn(si);var di,li;function ui(e){return e.length<1?1:Math.max.apply(null,e.map(e=>e.order))+1}function fi(e){for(let t=0;t<e.length;t++)e[t].order=t+1,qt(e[t],"columns")?fi(e[t].columns):qt(e[t],"controls")&&fi(e[t].controls)}!function(e){e[e.WebLogo=0]="WebLogo",e[e.HubLogo=1]="HubLogo",e[e.HeaderBackground=2]="HeaderBackground",e[e.GlobalNavLogo=3]="GlobalNavLogo"}(di||(di={})),function(e){e[e.Square=0]="Square",e[e.Rectangular=1]="Rectangular"}(li||(li={})),Tn(Ka,"items",Ja),Rn.prototype.getContextInfo=async function(e=this.parentUrl){const t=await Wn(Nn([this,va(e)],"_api/contextinfo"));if(qt(t,"GetContextWebInformation")){const e=t.GetContextWebInformation;return e.SupportedSchemaVersions=e.SupportedSchemaVersions.results,e}return t};let pi=class extends Bn{getByUrl(e){if(/%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return hi(this).concat(`('${ya(e)}')`)}async addUsingPath(e,t,n={Overwrite:!1}){const a=[`AddUsingPath(decodedurl='${ya(e)}'`];return n&&(n.Overwrite&&a.push(",Overwrite=true"),n.EnsureUniqueFileName&&a.push(`,EnsureUniqueFileName=${n.EnsureUniqueFileName}`),n.AutoCheckoutOnInvalidData&&a.push(",AutoCheckoutOnInvalidData=true"),Gt(n.XorHash)||a.push(`,XorHash=${ya(n.XorHash)}`)),a.push(")"),Wn(mi(this,a.join("")),{body:t})}async addChunked(e,t,n){const a=bi(this,(await this.addUsingPath(e,null,n)).ServerRelativeUrl);return a.using(Pn(()=>hi(a).delete())),a.setContentChunked(t,n)}async addTemplateFile(e,t){return Wn(mi(this,`addTemplateFile(urloffile='${ya(e)}',templatefiletype=${t})`))}};ba([Mn],pi.prototype,"addUsingPath",null),ba([Mn],pi.prototype,"addChunked",null),ba([Mn],pi.prototype,"addTemplateFile",null),pi=ba([ga("files")],pi);const mi=Hn(pi);class _i extends ni{constructor(){super(...arguments),this.delete=Kn()}get listItemAllFields(){return zn(this,"listItemAllFields")}get versions(){return yi(this)}async getLockedByUser(){const e=await(t=hi(this,"lockedByUser"),vn(t,_n,void 0));var t;return!0===e["odata.null"]?null:e}approve(e=""){return Wn(hi(this,`approve(comment='${ya(e)}')`))}cancelUpload(e){return Wn(hi(this,`cancelUpload(uploadId=guid'${e}')`))}checkin(e="",t=Di.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return Wn(hi(this,`checkin(comment='${ya(e)}',checkintype=${t})`))}checkout(){return Wn(hi(this,"checkout"))}copyTo(e,t=!0){return Wn(hi(this,`copyTo(strnewurl='${ya(e)}',boverwrite=${t})`))}async copyByPath(e,...t){let n={ShouldBypassSharedLocks:!0,ResetAuthorAndCreatedOnCopy:!0,KeepBoth:!1};return 2===t.length&&("boolean"==typeof t[1]?n.KeepBoth=t[1]:"object"==typeof t[1]&&(n={...n,...t[1]})),this.moveCopyImpl(e,n,t[0],"CopyFileByPath")}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return Wn(hi(this,`deny(comment='${ya(e)}')`))}async moveByPath(e,...t){let n={KeepBoth:!1,ShouldBypassSharedLocks:!0,RetainEditorAndModifiedOnMove:!1};return 2===t.length&&("boolean"==typeof t[1]?n.KeepBoth=t[1]:"object"==typeof t[1]&&(n={...n,...t[1]})),this.moveCopyImpl(e,n,t[0],"MoveFileByPath")}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return Wn(hi(this,`publish(comment='${ya(e)}')`))}recycle(){return Wn(hi(this,"recycle"))}async deleteWithParams(e){return Wn(hi(this,"DeleteWithParameters"),Un({parameters:e}))}undoCheckout(){return Wn(hi(this,"undoCheckout"))}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return Wn(hi(this,`unpublish(comment='${ya(e)}')`))}async exists(){try{return(await hi(this).select("Exists")()).Exists}catch(e){return!1}}async setContent(e){return await Wn(hi(this,"$value"),{body:e,headers:{"X-HTTP-Method":"PUT"}}),hi(this)}async getItem(...e){const t=this.listItemAllFields,n=await t.select(...e)();return Object.assign(Za([this,Ta(n)]),n)}async setContentChunked(e,t){const{progress:n}=function(e){return{progress:()=>null,...e}}(t),a=Bt();let i,r=!0,o=0;const s=hi(this).using(Pn(()=>hi(s).cancelUpload(a))),c="object"==typeof(l=d=e)&&"function"==typeof l.arrayBuffer&&"string"==typeof l.type&&"function"==typeof l.stream&&"function"==typeof l.constructor&&(/^(Blob|File)$/.test(l[Ci])||/^(Blob|File)$/.test(l.constructor.name))?d.stream():function(e){return"function"==typeof e.on}(d)?new ReadableStream({start(e){d.on("data",t=>{e.enqueue(t)}),d.on("end",()=>{e.close()})}}):function(e){return"object"==typeof e&&"number"==typeof e.length}(d)?new ReadableStream({start(e){e.enqueue(d),e.close()}}):function(e){return"object"==typeof e&&"object"==typeof e.readable}(d)?d.readable:d;var d,l;const u=c.getReader();for(;i=await u.read();){if(i.done)return n({offset:o,stage:"finishing",uploadId:a}),Wn(hi(s,`finishUpload(uploadId=guid'${a}',fileOffset=${o})`),{body:(null==i?void 0:i.value)||""});r?(n({offset:o,stage:"starting",uploadId:a}),o=await Wn(hi(s,`startUpload(uploadId=guid'${a}')`),{body:i.value}),r=!1):(n({offset:o,stage:"continue",uploadId:a}),o=await Wn(hi(s,`continueUpload(uploadId=guid'${a}',fileOffset=${o})`),{body:i.value}))}}moveCopyImpl(e,t,n,a){const i=hi(this);return i.on.pre(rn(async(i,r,o)=>{const{ServerRelativeUrl:s,"odata.id":c}=await hi(this).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).select("ServerRelativeUrl")(),d=new URL(va(c));return[Nt(d.toString(),`/_api/SP.MoveCopyUtil.${a}(overwrite=@a1)?@a1=${n}`),r=Un({destPath:Va(zt(e)?e:`${d.protocol}//${d.host}${e}`),options:t,srcPath:Va(zt(s)?s:`${d.protocol}//${d.host}${s}`)},r),o]})),Wn(i).then(()=>async function(e,t){return(zt(t)?gi:bi)(e,t)}(this,e))}}ba([Mn],_i.prototype,"copyByPath",null),ba([Mn],_i.prototype,"moveByPath",null),ba([Mn],_i.prototype,"setContentChunked",null);const hi=Hn(_i);function bi(e,t){return hi([e,va(e.toUrl())],`_api/web/getFileByServerRelativePath(decodedUrl='${ya(t)}')`)}async function gi(e,t){const{WebFullUrl:n}=await hi(e).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).getContextInfo(t),{pathname:a}=new URL(t);return bi(hi([e,Nt(n,"_api/web")]),decodeURIComponent(a))}let vi=class extends Bn{getById(e){return Si(this).concat(`(${e})`)}deleteAll(){return Wn(yi(this,"deleteAll"))}deleteById(e){return Wn(yi(this,`deleteById(vid=${e})`))}recycleByID(e){return Wn(yi(this,`recycleByID(vid=${e})`))}deleteByLabel(e){return Wn(yi(this,`deleteByLabel(versionlabel='${ya(e)}')`))}recycleByLabel(e){return Wn(yi(this,`recycleByLabel(versionlabel='${ya(e)}')`))}restoreByLabel(e){return Wn(yi(this,`restoreByLabel(versionlabel='${ya(e)}')`))}};vi=ba([ga("versions")],vi);const yi=Hn(vi),Si=Hn(class extends ni{constructor(){super(...arguments),this.delete=Gn()}});var Di,Ii,xi;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(Di||(Di={})),function(e){e[e.None=0]="None",e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets",e[e.RetainEditorAndModifiedOnMove=2048]="RetainEditorAndModifiedOnMove"}(Ii||(Ii={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(xi||(xi={}));const Ci=Symbol.toStringTag;xa.prototype.getFileByServerRelativePath=function(e){return bi(this,e)},xa.prototype.getFileById=function(e){return hi(this,`getFileById('${e}')`)},xa.prototype.getFileByUrl=function(e){return hi(this,`getFileByUrl('${ya("!@p1::"+e)}')`)};let Oi=class extends Bn{async add(e){"string"==typeof e&&(e={text:e});const t=await Wn(wi(this,null),Un(e));return Object.assign(this.getById(t.id),t)}getById(e){return Ei(this).concat(`(${e})`)}clear(){return Wn(wi(this,"DeleteAll"))}};Oi=ba([ga("comments")],Oi);const wi=Hn(Oi),Ei=Hn(class extends Vn{get replies(){return Li(this)}like(){return Wn(Ei(this,"Like"))}unlike(){return Wn(Ei(this,"Unlike"))}delete(){return Jn(this)}});let Ai=class extends Bn{async add(e){"string"==typeof e&&(e={text:e});const t=await Wn(Li(this,null),Un(e));return Object.assign(Ei([this,Ta(t)]),t)}};Ai=ba([ga("replies")],Ai);const Li=Hn(Ai);var ki;Tn(Xa,"comments",wi),Xa.prototype.getLikedBy=function(){return Wn(Za(this,"likedBy"))},Xa.prototype.like=async function(){const e=await this.getParentInfos(),t=Nt(va(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=true`;return Wn(Nn([this,t]))},Xa.prototype.unlike=async function(){const e=await this.getParentInfos(),t=Nt(va(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=false`;return Wn(Nn([this,t]))},Xa.prototype.getLikedByInformation=function(){return Za(this,"likedByInformation").expand("likedby")()},Xa.prototype.rate=async function(e){const t=await this.getParentInfos(),n=Nt(va(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetRating(listID=@a1,itemID=@a2,rating=@a3)")+`?@a1='{${t.ParentList.Id}}'&@a2='${t.Item.Id}'&@a3=${e}`;return Wn(Nn([this,n]))},function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(ki||(ki={}));class Mi extends Rn{constructor(e,t,n,a=!1,i=[],r=!1){super(e,t),this.json=n,this.sections=i,this.commentsDisabled=r,this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,this.parentUrl="",this._url=Nt(va(this._url),t),this._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},this._layoutPart=Mi.getDefaultLayoutPart(),void 0===n||a||this.fromJSON(n)}static getDefaultLayoutPart(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:"",enableGradientEffect:!0},reservedHeight:280,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}}get pageLayout(){return this.json.PageLayoutType}set pageLayout(e){this.json.PageLayoutType=e}get bannerImageUrl(){return this.json.BannerImageUrl}set bannerImageUrl(e){this.setBannerImage(e)}get thumbnailUrl(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl}set thumbnailUrl(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1}get topicHeader(){return Kt(this.json.TopicHeader)?this.json.TopicHeader:""}set topicHeader(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,Gt(e)&&(this.showTopicHeader=!1)}get title(){return this.json.Title}set title(e){this.json.Title=e,this._layoutPart.properties.title=e}get reservedHeight(){return this._layoutPart.reservedHeight}set reservedHeight(e){this._layoutPart.reservedHeight=e}get description(){return this.json.Description}set description(e){if(!Gt(e)&&e.length>255)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,qt(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1}get layoutType(){return this._layoutPart.properties.layoutType}set layoutType(e){this._layoutPart.properties.layoutType=e}get headerTextAlignment(){return this._layoutPart.properties.textAlignment}set headerTextAlignment(e){this._layoutPart.properties.textAlignment=e}get showTopicHeader(){return this._layoutPart.properties.showTopicHeader}set showTopicHeader(e){this._layoutPart.properties.showTopicHeader=e}get showPublishDate(){return this._layoutPart.properties.showPublishDate}set showPublishDate(e){this._layoutPart.properties.showPublishDate=e}get hasVerticalSection(){return this.sections.findIndex(e=>2===e.layoutIndex)>-1}get authorByLine(){return Vt(this._layoutPart.properties.authorByline)&&this._layoutPart.properties.authorByline.length>0?this._layoutPart.properties.authorByline[0]:null}get verticalSection(){return this.hasVerticalSection?this.addVerticalSection():null}addSection(){const e=new Ui(this,ui(this.sections),1);return this.sections.push(e),e}addVerticalSection(){const e=this.sections.findIndex(e=>2===e.layoutIndex);if(e>-1)return this.sections[e];const t=new Ui(this,ui(this.sections),2);return this.sections.push(t),t}fromJSON(e){this.json=e;const t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&n.length>0&&(this._layoutPart=n[0]),this.setControls(t),this}async load(){const e=await this.getItem("Id","CommentsDisabled"),t=await Nn(this,`_api/sitepages/pages(${e.Id})`)();return this.commentsDisabled=e.CommentsDisabled,this.fromJSON(t)}async save(e=!0){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const t="_layouts/15/getpreview.ashx";if(this._bannerImageDirty&&!this.bannerImageUrl.includes(t)){const e=this.bannerImageUrl;let n,a;const i=Ca(this),[r,o]=Ra(i);i.using(r),i.getFileByServerRelativePath(e.replace(/%20/gi," ")).select("ListId","WebId","UniqueId","Name","SiteId")().then(e=>n=e),i.select("Url")().then(e=>a=e.Url),await o();const s=Nn(a,t);s.query.set("guidSite",`${n.SiteId}`),s.query.set("guidWeb",`${n.WebId}`),s.query.set("guidFile",`${n.UniqueId}`),this.bannerImageUrl=s.toRequestUrl(),Kt(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:e},Kt(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:n.ListId,siteId:n.SiteId,uniqueId:n.UniqueId,webId:n.WebId},this._layoutPart.properties.webId=n.WebId,this._layoutPart.properties.siteId=n.SiteId,this._layoutPart.properties.listId=n.ListId,this._layoutPart.properties.uniqueId=n.UniqueId}this.json.IsPageCheckedOutToCurrentUser||await Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/checkoutpage`));let n={AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader,BannerImageUrl:this.bannerImageUrl};(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty)&&(n={BannerImageUrl:this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl,...n});const a=Pi(this,`_api/sitepages/pages(${this.json.Id})/savepage`);await Wn(a,Fn({"if-match":"*"},Un(n)));let i=!0;return e&&(i=await Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/publish`)),i&&(this.json.IsPageCheckedOutToCurrentUser=!1)),this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,await this.load(),i}async discardPageCheckout(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const e=await Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/discardPage`));this.fromJSON(e)}async promoteToNews(){return this.promoteNewsImpl("promoteToNews")}findControlById(e){return this.findControl(t=>t.id===e)}findControl(e){for(let t=0;t<this.sections.length;t++)for(let n=0;n<this.sections[t].columns.length;n++)for(let a=0;a<this.sections[t].columns[n].controls.length;a++)if(e(this.sections[t].columns[n].controls[a]))return this.sections[t].columns[n].controls[a];return null}async copy(e,t,n,a=!0,i){const r=await Ti(e,t,n,this.pageLayout,i);return this.copyTo(r,a)}async copyTo(e,t=!0){if(e.setControls(this.getControls()),this._layoutPart.properties&&(qt(this._layoutPart.properties,"topicHeader")&&(e.topicHeader=this._layoutPart.properties.topicHeader),qt(this._layoutPart.properties,"imageSourceType")&&(e._layoutPart.properties.imageSourceType=this._layoutPart.properties.imageSourceType),qt(this._layoutPart.properties,"layoutType")&&(e._layoutPart.properties.layoutType=this._layoutPart.properties.layoutType),qt(this._layoutPart.properties,"textAlignment")&&(e._layoutPart.properties.textAlignment=this._layoutPart.properties.textAlignment),qt(this._layoutPart.properties,"showTopicHeader")&&(e._layoutPart.properties.showTopicHeader=this._layoutPart.properties.showTopicHeader),qt(this._layoutPart.properties,"showPublishDate")&&(e._layoutPart.properties.showPublishDate=this._layoutPart.properties.showPublishDate),qt(this._layoutPart.properties,"enableGradientEffect")&&(e._layoutPart.properties.enableGradientEffect=this._layoutPart.properties.enableGradientEffect)),!Gt(this.json.BannerImageUrl)){const t=new URL(this.json.BannerImageUrl),n=e=>e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5");if(t.searchParams.has("guidSite")&&t.searchParams.has("guidWeb")&&t.searchParams.has("guidFile")){const a=n(t.searchParams.get("guidSite")),i=n(t.searchParams.get("guidWeb")),r=n(t.searchParams.get("guidFile")),o=ci(this);if((await o.select("Id")()).Id===a){const t=await o.openWebById(i),n=await t.web.getFileById(r).select("ServerRelativeUrl")(),a={};this._layoutPart.properties&&(qt(this._layoutPart.properties,"translateX")&&(a.translateX=this._layoutPart.properties.translateX),qt(this._layoutPart.properties,"translateY")&&(a.translateY=this._layoutPart.properties.translateY),qt(this._layoutPart.properties,"imageSourceType")&&(a.imageSourceType=this._layoutPart.properties.imageSourceType),qt(this._layoutPart.properties,"altText")&&(a.altText=this._layoutPart.properties.altText)),e.setBannerImage(n.ServerRelativeUrl,a)}}}return await e.save(t),e}setBannerImage(e,t){zt(e)&&(e=e.replace(/^https?:\/\/[a-z0-9.]*?\.[a-z]{2,3}\//i,"/")),this.json.BannerImageUrl=e,this._layoutPart.serverProcessedContent={imageSources:{imageSource:e}},this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,Kt(t)&&(qt(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),qt(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),qt(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),qt(t,"altText")&&(this._layoutPart.properties.altText=t.altText))}async setBannerImageFromExternalUrl(e,t){const n=new URL(e),a=this.json.FileName.replace(/\.[^/.]+$/,""),i=n.pathname.split(/[\\/]/i).pop(),r=Pi(this,"_api/sitepages/AddImageFromExternalUrl");r.query.set("imageFileName",`'${i}'`),r.query.set("pageName",`'${a}'`),r.query.set("externalUrl",`'${e}'`),r.select("ServerRelativeUrl");const o=await Wn(r);this.setBannerImage(o.ServerRelativeUrl,t)}async setAuthorById(e){const t=await jn([this,va(this.toUrl())],"/_api/web/siteusers").filter(`Id eq ${e}`).select("LoginName")();if(t.length<1)throw Error(`Could not find user with id ${e}.`);return this.setAuthorByLoginName(t[0].LoginName)}async setAuthorByLoginName(e){const t=await jn([this,va(this.toUrl())],"/_api/web/siteusers").filter(`LoginName eq '${e}'`).select("UserPrincipalName","Title")();if(t.length<1)throw Error(`Could not find user with login name '${e}'.`);this.json.AuthorByline=[t[0].UserPrincipalName],this._layoutPart.properties.authorByline=[t[0].UserPrincipalName],this._layoutPart.properties.authors=[{id:e,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}]}async getItem(...e){const t=Pi(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),n=await Wn(t),a=Wa([this,n["odata.id"]]).items.getById(this.json.Id),i=await a.select(...e)();return Object.assign(Za([this,Ta(i)]),i)}async recycle(){const e=await this.getItem();await e.recycle()}async delete(){const e=await this.getItem();await e.delete()}async schedulePublish(e){return Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/SchedulePublish`),Un({sitePage:{PublishStartDate:e}}))}async saveAsTemplate(e=!0){const t=await Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/SavePageAsTemplate`)),n=Pi(this,null,t);return n.title=this.title,await n.save(e),n}share(e,t){return Wn(Pi(this,"_api/SP.Publishing.RichSharing/SharePageByEmail"),Un({recipientEmails:e,message:t,url:this.json.AbsoluteUrl}))}getCanvasContent1(){return JSON.stringify(this.getControls())}getLayoutWebpartsContent(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)}setControls(e){if(this.sections=[],e&&e.length){for(let t=0;t<e.length;t++)switch(qt(e[t],"controlType")?e[t].controlType:0){case 0:qt(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new Fi(e[t]));break;case 3:{const n=new Ni(e[t]);this.mergePartToTree(n,n.data.position);break}case 4:{const n=e[t],a=new Ri(n.innerHTML,n);this.mergePartToTree(a,a.data.position);break}}fi(this.sections)}}getControls(){fi(this.sections);const e=[];return this.sections.forEach(t=>{t.columns.forEach(n=>{n.controls.length<1?e.push({displayMode:n.data.displayMode,emphasis:this.getEmphasisObj(t.emphasis),position:n.data.position}):n.controls.forEach(n=>{n.data.emphasis=this.getEmphasisObj(t.emphasis),e.push(this.specialSaveHandling(n).data)})})}),e.push(this._pageSettings),e}getEmphasisObj(e){return e<1||e>3?{}:{zoneEmphasis:e}}async promoteNewsImpl(e){if(null===this.json.Id)throw Error("The id for this page is null.");return Gt(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3&&await this.save(!0),Wn(Pi(this,`_api/sitepages/pages(${this.json.Id})/${e}`))}mergePartToTree(e,t){var n,a,i;let r=null,o=12,s=0,c=0,d=1;t&&(qt(t,"zoneIndex")&&(c=t.zoneIndex),qt(t,"sectionIndex")&&(s=t.sectionIndex),qt(t,"sectionFactor")&&(o=t.sectionFactor),qt(t,"layoutIndex")&&(d=t.layoutIndex));const l=null!==(i=null===(a=null===(n=e.data)||void 0===n?void 0:n.emphasis)||void 0===a?void 0:a.zoneEmphasis)&&void 0!==i?i:0,u=this.getOrCreateSection(c,d,l),f=u.columns.filter(e=>e.order===s);r=f.length<1?u.addColumn(o,d):f[0],e.column=r,r.addControl(e)}mergeColumnToTree(e){var t,n;const a=qt(e.data,"position")&&qt(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,i=qt(e.data,"position")&&qt(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,r=this.getOrCreateSection(a,i,(null===(n=null===(t=e.data)||void 0===t?void 0:t.emphasis)||void 0===n?void 0:n.zoneEmphasis)||0);e.section=r,r.columns.push(e)}getOrCreateSection(e,t,n){let a=null;const i=this.sections.filter(n=>n.order===e&&n.layoutIndex===t);return i.length<1?(a=2===t?this.addVerticalSection():this.addSection(),a.order=e,a.emphasis=n):a=i[0],a}specialSaveHandling(e){var t,n,a;if(3===e.data.controlType){const i=(null===(a=null===(n=null===(t=e.data)||void 0===t?void 0:t.webPartData)||void 0===n?void 0:n.serverProcessedContent)||void 0===a?void 0:a.searchablePlainTexts)||null;if(Kt(i)){const t=Object.getOwnPropertyNames(i);for(let n=0;n<t.length;n++)i[t[n]]=i[t[n]].replace(/</gi,"&lt;"),e.data.webPartData.serverProcessedContent.searchablePlainTexts=i}}return e}}const Pi=(e,t,n,a=!1,i=[],r=!1)=>new Mi(e,t,n,a,i,r),Ti=async(e,t,n,a="Article",i=0)=>{t=t.replace(/\.aspx$/i,"");const r=await Wn(Pi(e,"_api/sitepages/pages"),Un({PageLayoutType:a,PromotedState:i})),o=Pi(e,"",r);return o.title=t,await o.save(!1),o.title=n,o};class Ui{constructor(e,t,n,a=[],i=0){this.page=e,this.columns=a,this._emphasis=i,this._memId=Bt(),this._order=t,this._layoutIndex=n}get order(){return this._order}set order(e){this._order=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e}get layoutIndex(){return this._layoutIndex}set layoutIndex(e){this._layoutIndex=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e,t=this.layoutIndex){const n=new Fi;return n.section=this,n.data.position.zoneIndex=this.order,n.data.position.layoutIndex=t,n.data.position.sectionFactor=e,n.order=ui(this.columns),this.columns.push(n),n}addControl(e){return this.defaultColumn.addControl(e),this}get emphasis(){return this._emphasis}set emphasis(e){this._emphasis=e}remove(){this.page.sections=this.page.sections.filter(e=>e._memId!==this._memId),fi(this.page.sections)}}class Fi{constructor(e=JSON.parse(JSON.stringify(Fi.Default)),t=[]){this.json=e,this.controls=t,this._section=null,this._memId=Bt()}get data(){return this.json}get section(){return this._section}set section(e){this._section=e}get order(){return this.data.position.sectionIndex}set order(e){this.data.position.sectionIndex=e;for(let t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e}get factor(){return this.data.position.sectionFactor}set factor(e){this.data.position.sectionFactor=e}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}remove(){this.section.columns=this.section.columns.filter(e=>e._memId!==this._memId),fi(this.section.columns)}}Fi.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Hi{constructor(e){this.json=e}get id(){return this.json.id}get data(){return this.json}get column(){return this._column}set column(e){this._column=e,this.onColumnChange(this._column)}remove(){this.column.controls=this.column.controls.filter(e=>e.id!==this.id),fi(this.column.controls)}setData(e){this.json=e}}class Ri extends Hi{constructor(e,t=JSON.parse(JSON.stringify(Ri.Default))){Gt(t.id)&&(t.id=Bt(),t.anchorComponentId=t.id),super(t),this.text=e}get text(){return this.data.innerHTML}set text(e){this.data.innerHTML=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=ui(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex}}Ri.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Ni extends Hi{constructor(e=JSON.parse(JSON.stringify(Ni.Default))){super(e)}static fromComponentDef(e){const t=new Ni;return t.import(e),t}get title(){return this.data.webPartData.title}set title(e){this.data.webPartData.title=e}get description(){return this.data.webPartData.description}set description(e){this.data.webPartData.description=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}get height(){return this.data.reservedHeight}set height(e){this.data.reservedHeight=e}get width(){return this.data.reservedWidth}set width(e){this.data.reservedWidth=e}get dataVersion(){return this.data.webPartData.dataVersion}set dataVersion(e){this.data.webPartData.dataVersion=e}setProperties(e){return this.data.webPartData.properties={...this.data.webPartData.properties,...e},this}getProperties(){return this.data.webPartData.properties}setServerProcessedContent(e){return this.data.webPartData.serverProcessedContent={...this.data.webPartData.serverProcessedContent,...e},this}getServerProcessedContent(){return this.data.webPartData.serverProcessedContent}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=ui(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex}import(e){const t=Bt(),n=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),a=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:a.description.default,id:n,instanceId:t,properties:a.properties,title:a.title.default},webPartId:n}))}}Ni.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},xa.prototype.getClientsideWebParts=function(){return jn(this,"GetClientSideWebParts")()},xa.prototype.addClientsidePage=function(e,t=e.replace(/\.[^/.]+$/,""),n,a){return Ti(this,e,t,n,a)},xa.prototype.loadClientsidePage=function(e){return(async e=>{const t=await e.getItem();return Pi([e,va(e.toUrl())],"",{Id:t.Id},!0).load()})(this.getFileByServerRelativePath(e))},xa.prototype.addRepostPage=async function(e){const t=zn([this,va(this.toUrl())],"_api/sitepages/pages/reposts");return(await Wn(t,Un(e))).AbsoluteUrl},xa.prototype.addFullPageApp=async function(e,t=e.replace(/\.[^/.]+$/,""),n,a){const i=await this.getClientsideWebParts(),r=new RegExp(`{?${n}}?`,"i"),o=i.find(e=>r.test(e.Id)),s=Ni.fromComponentDef(o),c=await this.addClientsidePage(e,t,"SingleWebPartAppPage",a);return c.addSection().addColumn(12).addControl(s),c};let Bi=class extends Bn{getByUrl(e){return zi(this).concat(`('${ya(e)}')`)}async addUsingPath(e,t=!1){return Wn(ji(this,`addUsingPath(DecodedUrl='${ya(e)}',overwrite=${t})`))}};Bi=ba([ga("folders")],Bi);const ji=Hn(Bi);class Vi extends Vn{constructor(){super(...arguments),this.delete=Kn()}get folders(){return ji(this)}get listItemAllFields(){return zn(this,"listItemAllFields")}get parentFolder(){return zi(this,"parentFolder")}get properties(){return zn(this,"properties")}get storageMetrics(){return zn(this,"storagemetrics")}async update(e){return qn(this,Un(e))}recycle(){return Wn(zi(this,"recycle"))}async getItem(...e){const t=this.listItemAllFields,n=await t.select(...e)();if(n["odata.null"])throw Error("No associated item was found for this folder. It may be the root folder, which does not have an item.");return Object.assign(Za([this,Ta(n)]),n)}async moveByPath(e,...t){let n={KeepBoth:!1,ShouldBypassSharedLocks:!0,RetainEditorAndModifiedOnMove:!1};return 1===t.length&&("boolean"==typeof t[0]?n.KeepBoth=t[0]:"object"==typeof t[0]&&(n={...n,...t[0]})),this.moveCopyImpl(e,n,"MoveFolderByPath")}async copyByPath(e,...t){let n={ShouldBypassSharedLocks:!0,ResetAuthorAndCreatedOnCopy:!0,KeepBoth:!1};return 1===t.length&&("boolean"==typeof t[0]?n.KeepBoth=t[0]:"object"==typeof t[0]&&(n={...n,...t[0]})),this.moveCopyImpl(e,n,"CopyFolderByPath")}async deleteWithParams(e){return Wn(zi(this,"DeleteWithParameters"),Un({parameters:e}))}async addSubFolderUsingPath(e){return await Wn(zi(this,"AddSubFolderUsingPath"),Un({leafPath:Va(e)})),this.folders.getByUrl(e)}async getParentInfos(){const e=await this.select("ServerRelativeUrl","ListItemAllFields/ParentList/Id","ListItemAllFields/ParentList/RootFolder/UniqueId","ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl","ListItemAllFields/ParentList/RootFolder/ServerRelativePath","ListItemAllFields/ParentList/ParentWeb/Id","ListItemAllFields/ParentList/ParentWeb/Url","ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl","ListItemAllFields/ParentList/ParentWeb/ServerRelativePath").expand("ListItemAllFields/ParentList","ListItemAllFields/ParentList/RootFolder","ListItemAllFields/ParentList/ParentWeb")();return{Folder:{ServerRelativeUrl:e.ServerRelativeUrl},ParentList:{Id:e.ListItemAllFields.ParentList.Id,RootFolderServerRelativePath:e.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ListItemAllFields.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ListItemAllFields.ParentList.ParentWeb.Id,ServerRelativePath:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ListItemAllFields.ParentList.ParentWeb.Url}}}moveCopyImpl(e,t,n){const a=zi(this);return a.on.pre(rn(async(a,i,r)=>{const o=await zi(this).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).getParentInfos(),s=new URL(o.ParentWeb.Url);return[Nt(o.ParentWeb.Url,`/_api/SP.MoveCopyUtil.${n}()`),i=Un({destPath:Va(zt(e)?e:Nt(s.origin,e)),options:t,srcPath:Va(Nt(s.origin,o.Folder.ServerRelativeUrl))},i),r]})),Wn(a).then(()=>async function(e,t){return(zt(t)?Ki:Gi)(e,t)}(this,e))}}ba([Mn],Vi.prototype,"moveByPath",null),ba([Mn],Vi.prototype,"copyByPath",null);const zi=Hn(Vi);function Gi(e,t){return zi([e,va(e.toUrl())],`_api/web/getFolderByServerRelativePath(decodedUrl='${ya(t)}')`)}async function Ki(e,t){const{WebFullUrl:n}=await zi(e).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).getContextInfo(t),{pathname:a}=new URL(t);return Gi(zi([e,Nt(n,"_api/web")]),decodeURIComponent(a))}Tn(Ka,"rootFolder",zi),Ka.prototype.getDefaultColumnValues=async function(){const e=await this.rootFolder.select("ServerRelativePath")(),t=await this.select("ParentWeb/Url").expand("ParentWeb")(),n=Nt("/",e.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),a=Nt(t.ParentWeb.Url,`_api/web/getFileByServerRelativePath(decodedUrl='${ya(n)}')`);let i="";try{i=await zi([this,a],"$value").using(Sn())()}catch(e){if(e&&e.status&&404===e.status)return[];throw e}const r=i.match(/<a.*?<\/a>/gi);return(null===r?[]:r.map(e=>e.trim())).reduce((e,t)=>{const n=/<a href="(.*?)">/gi.exec(t);if(n.length<1)return this.log(`Could not parse default column value from '${t}'`,2),null;const a=t.match(/<DefaultValue.*?<\/DefaultValue>/gi);return(null===a?[]:a.map(e=>e.trim())).map(t=>{const a=/<DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(t);a.length<1?this.log(`Could not parse default column value from '${t}'`,2):e.push({name:a[1],path:decodeURIComponent(n[1]),value:a[2]})}),e},[]).filter(e=>null!==e)},Ka.prototype.setDefaultColumnValues=async function(e){const t=await jn(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")(),n={};for(let t=0;t<e.length;t++)null==n[e[t].path]?n[e[t].path]=[e[t]]:n[e[t].path].push(e[t]);const a=Object.getOwnPropertyNames(n),i=[];for(let e=0;e<a.length;e++){const r=n[a[e]],o=r.map(e=>{const n=t.findIndex(t=>t.InternalName===e.name);if(n<0)throw Error(`Field '${e.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);const a=t[n];let i="";switch(a.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(Vt(e.value))throw Error(`The type '${a.TypeAsString}' does not support multiple values.`);i=`${e.value}`;break;case"MultiChoice":i=Vt(e.value)?e.value.map(e=>`${e}`).join(";"):`${e.value}`;break;case"UserMulti":i=Vt(e.value)?e.value.map(e=>`${e}`).join(";#"):`${e.value}`;break;case"Taxonomy":case"TaxonomyFieldType":if(Vt(e.value))throw Error(`The type '${a.TypeAsString}' does not support multiple values.`);i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`;break;case"TaxonomyMulti":case"TaxonomyFieldTypeMulti":i=Vt(e.value)?e.value.map(e=>`${e.wssId};#${e.termName}|${e.termId}`).join(";#"):[e.value].map(e=>`${e.wssId};#${e.termName}|${e.termId}`).join(";#")}return`<DefaultValue FieldName="${e.name}">${i}</DefaultValue>`}),s=`<a href="${r[0].path.replace(/ /gi,"%20")}">${o.join("")}</a>`;i.push(s)}const r=`<MetadataDefaults>${i.join("")}</MetadataDefaults>`,o=await this.rootFolder.select("ServerRelativePath")(),s=await this.select("ParentWeb/Url").expand("ParentWeb")(),c=Nt("/",o.ServerRelativePath.DecodedUrl,"Forms"),d=Nt(s.ParentWeb.Url,"_api/web",`getFolderByServerRelativePath(decodedUrl='${ya(c)}')`,"files");await Wn(zi([this,d],"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:r}),(await this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()).length<1&&await Wn(Wa(this.eventReceivers,"add"),Un({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}}))},Tn(xa,"lists",Ga),Tn(xa,"siteUserInfoList",Wa),Tn(xa,"defaultDocumentLibrary",Wa),Tn(xa,"customListTemplates",jn,"getcustomlisttemplates"),xa.prototype.getList=function(e){return Wa(this,`getList('${ya(e)}')`)},xa.prototype.getCatalog=async function(e){const t=await Ca(this,`getcatalog(${e})`).select("Id")();return Wa([this,Ta(t)])},Vi.prototype.getDefaultColumnValues=async function(){const e=await zi(this,"Properties").select("vti_x005f_listname")(),{ServerRelativePath:t}=await this.select("ServerRelativePath")(),n=Ca([this,va(Ta(e))]).lists.getById(e.vti_x005f_listname);return(await n.getDefaultColumnValues()).filter(e=>e.path.toLowerCase()===t.DecodedUrl.toLowerCase())},Vi.prototype.setDefaultColumnValues=async function(e,t=!0){const n=await zi(this,"Properties").select("vti_x005f_listname")(),a=Ca([this,va(Ta(n))]).lists.getById(n.vti_x005f_listname),i=(await this.select("ServerRelativePath")()).ServerRelativePath.DecodedUrl,r=await a.getDefaultColumnValues(),o=t?r:r.filter(e=>e.path!==i);e.forEach(e=>{const t=o.find(t=>t.name===e.name&&t.path===i);t?t.value=e.value:o.push({name:e.name,path:i,value:e.value})}),await a.setDefaultColumnValues(o)},Vi.prototype.clearDefaultColumnValues=async function(){await this.setDefaultColumnValues([],!1)};let Wi=class extends Bn{async addAvailableContentType(e){const t=await Wn(qi(this,"addAvailableContentType"),Un({contentTypeId:e}));return{contentType:this.getById(t.id),data:t}}getById(e){return Yi(this).concat(`('${e}')`)}async add(e,t,n="",a="Custom Content Types",i={}){const r=Un({Description:n,Group:a,Id:{StringValue:e},Name:t,...i}),o=await Wn(this,r);return{contentType:this.getById(o.id),data:o}}};Wi=ba([ga("contenttypes")],Wi);const qi=Hn(Wi);class Qi extends Vn{constructor(){super(...arguments),this.delete=Gn()}async update(e){return qn(this,Un(e))}get fieldLinks(){return Xi(this)}get fields(){return jn(this,"fields")}get parent(){return Yi(this,"parent")}get workflowAssociations(){return jn(this,"workflowAssociations")}}const Yi=Hn(Qi);let Ji=class extends Bn{getById(e){return Zi(this).concat(`(guid'${e}')`)}};Ji=ba([ga("fieldlinks")],Ji);const Xi=Hn(Ji),Zi=Hn(class extends Vn{});Tn(xa,"contentTypes",qi),Tn(Xa,"contentType",Yi),Tn(Ka,"contentTypes",qi);let $i=class extends Bn{async add(e,t=!1){return{data:await Wn(er(this,"add"),Un({featdefScope:0,featureId:e,force:t})),feature:this.getById(e)}}getById(e){return tr(this).concat(`('${e}')`)}remove(e,t=!1){return Wn(er(this,"remove"),Un({featureId:e,force:t}))}};$i=ba([ga("features")],$i);const er=Hn($i),tr=Hn(class extends Vn{});Tn(si,"features",er),Tn(xa,"features",er);let nr=class extends Bn{async createFieldAsXml(e){return"string"==typeof e&&(e={SchemaXml:e}),Wn(ar(this,"createfieldasxml"),Un({parameters:e}))}getById(e){return rr(this).concat(`('${e}')`)}getByTitle(e){return rr(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return rr(this,`getByInternalNameOrTitle('${e}')`)}async add(e,t,n){return Wn(ar(this,null),Un(Object.assign({__metadata:{type:null!==(a=sr[t])&&void 0!==a?a:"SP.Field"}},{Title:e,FieldTypeKind:t,...n}),Fn({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"})));var a}async addField(e,t,n){return Wn(ar(this,"AddField"),Un({parameters:{Title:e,FieldTypeKind:t,...n}}))}addText(e,t){return this.add(e,2,{MaxLength:255,...t})}addCalculated(e,t){return this.add(e,17,{OutputType:or.Text,...t})}addDateTime(e,t){return this.add(e,4,{DateTimeCalendarType:ur.Gregorian,DisplayFormat:cr.DateOnly,FriendlyDisplayFormat:dr.Unspecified,...t})}addNumber(e,t){return this.add(e,9,t)}addCurrency(e,t){return this.add(e,10,{CurrencyLocaleId:1033,...t})}addMultilineText(e,t){return this.add(e,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...t})}addUrl(e,t){return this.add(e,11,{DisplayFormat:fr.Hyperlink,...t})}addUser(e,t){return this.add(e,20,{SelectionMode:pr.PeopleAndGroups,...t})}async addLookup(e,t){return this.addField(e,7,t)}addChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,6,n)}addMultiChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,15,n)}addBoolean(e,t){return this.add(e,8,t)}async addDependentLookupField(e,t,n){return Wn(ar(this,`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${n}')`))}addLocation(e,t){return this.add(e,33,t)}addImageField(e,t){return this.add(e,34,t)}};nr=ba([ga("fields")],nr);const ar=Hn(nr);class ir extends Vn{constructor(){super(...arguments),this.delete=Gn()}async update(e,t){return null==t&&(t=(await rr(this).select("FieldTypeKind")())["odata.type"]),qn(this,Un(e))}setShowInDisplayForm(e){return Wn(rr(this,`setshowindisplayform(${e})`))}setShowInEditForm(e){return Wn(rr(this,`setshowineditform(${e})`))}setShowInNewForm(e){return Wn(rr(this,`setshowinnewform(${e})`))}}const rr=Hn(ir);var or;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType",e[e.Location=33]="Location",e[e.Image=34]="Image"}(or||(or={}));const sr={[or.Calculated]:"SP.FieldCalculated",[or.Choice]:"SP.FieldChoice",[or.Computed]:"SP.FieldComputed",[or.Currency]:"SP.FieldCurrency",[or.DateTime]:"SP.FieldDateTime",[or.GridChoice]:"SP.FieldRatingScale",[or.Guid]:"SP.FieldGuid",[or.Image]:"SP.FieldMultiLineText",[or.Integer]:"SP.FieldNumber",[or.Location]:"SP.FieldLocation",[or.Lookup]:"SP.FieldLookup",[or.ModStat]:"SP.FieldChoice",[or.MultiChoice]:"SP.FieldMultiChoice",[or.Note]:"SP.FieldMultiLineText",[or.Number]:"SP.FieldNumber",[or.Text]:"SP.FieldText",[or.URL]:"SP.FieldUrl",[or.User]:"SP.FieldUser",[or.WorkflowStatus]:"SP.FieldChoice",[or.WorkflowEventType]:"SP.FieldNumber"};var cr,dr,lr,ur,fr,pr,mr;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(cr||(cr={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(dr||(dr={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(lr||(lr={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(ur||(ur={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(fr||(fr={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(pr||(pr={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(mr||(mr={})),Tn(xa,"fields",ar),Tn(xa,"availablefields",ar),Tn(Ka,"fields",ar),Tn(Vi,"files",mi),Tn(Xa,"file",hi,"file"),Tn(Xa,"folder",zi),Tn(Ka,"rootFolder",zi),Tn(xa,"folders",ji),Tn(xa,"rootFolder",zi),xa.prototype.getFolderByServerRelativePath=function(e){return Gi(this,e)},xa.prototype.getFolderById=function(e){return zi(this,`getFolderById('${e}')`)};let _r=class extends Bn{getById(e){return br(this).concat(`('${e}')`)}};_r=ba([ga("forms")],_r);const hr=Hn(_r),br=Hn(class extends Vn{});Tn(Ka,"forms",hr);let gr=class extends Bn{getById(e){return yr(this,`GetById?hubSiteId='${e}'`)}};gr=ba([ga("_api/hubsites")],gr);const vr=Hn(gr),yr=Hn(class extends Vn{async getSite(){const e=await this.select("SiteUrl")();return ci([this,e.SiteUrl])}});si.prototype.joinHubSite=async function(e){await Wn(ci(this,`joinHubSite('${e}')`))},si.prototype.registerHubSite=async function(){await Wn(ci(this,"registerHubSite"))},si.prototype.unRegisterHubSite=async function(){await Wn(ci(this,"unRegisterHubSite"))},xa.prototype.hubSiteData=async function(e=!1){const t=await Ca(this,`hubSiteData(${e})`)();return"string"==typeof t?JSON.parse(t):t},xa.prototype.syncHubSiteTheme=function(){return Wn(Ca(this,"syncHubSiteTheme"))},Reflect.defineProperty(_a.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return this.create(vr)}});const Sr=Hn(class extends Bn{getById(e){return Dr(this).concat(`(${e})`)}async add(e,t,n=!0){const a=Un({IsVisible:n,Title:e,Url:t});return Wn(Sr(this,null),a)}moveAfter(e,t){const n=Un({nodeId:e,previousNodeId:t});return Wn(Sr(this,"MoveAfter"),n)}}),Dr=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Gn()}get children(){return Sr(this,"children")}async update(e){return{data:await qn(this,Un(e)),node:this}}});let Ir=class extends Rn{get quicklaunch(){return Sr(this,"quicklaunch")}get topNavigationBar(){return Sr(this,"topnavigationbar")}};Ir=ba([ga("navigation")],Ir);const xr=Hn(Ir);class Cr extends Rn{constructor(e=null,t){super(e,t),this._url=Nt(va(this._url),"_api/navigation",t)}getMenuState(e=null,t=10,n=null,a=null){return Wn(Or(this,"MenuState"),Un({customProperties:a,depth:t,mapProviderName:n,menuNodeKey:e}))}getMenuNodeKey(e,t=null){return Wn(Or(this,"MenuNodeKey"),Un({currentUrl:e,mapProviderName:t}))}}const Or=(e,t)=>new Cr(e,t);Tn(xa,"navigation",xr),Reflect.defineProperty(_a.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return this.create(Or)}});const wr=Hn(class extends Vn{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new Lr(e).using(dn(this)),this.profileLoader=new Er(e).using(dn(this))}getEditProfileLink(){return wr(this,"EditProfileLink")()}getIsMyPeopleListPublic(){return wr(this,"IsMyPeopleListPublic")()}amIFollowedBy(e){const t=wr(this,"amifollowedby(@v)");return t.query.set("@v",`'${e}'`),t()}amIFollowing(e){const t=wr(this,"amifollowing(@v)");return t.query.set("@v",`'${e}'`),t()}getFollowedTags(e=20){return wr(this,`getfollowedtags(${e})`)()}getFollowersFor(e){const t=wr(this,"getfollowersfor(@v)");return t.query.set("@v",`'${e}'`),t()}get myFollowers(){return jn(this,"getmyfollowers")}get myProperties(){return wr(this,"getmyproperties")}getPeopleFollowedBy(e){const t=wr(this,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${e}'`),t()}getPropertiesFor(e){const t=wr(this,"getpropertiesfor(@v)");return t.query.set("@v",`'${e}'`),t()}get trendingTags(){const e=wr(this,null);return e.concat(".gettrendingtags"),e()}getUserProfilePropertyFor(e,t){const n=wr(this,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return n.query.set("@v",`'${e}'`),n()}hideSuggestion(e){const t=wr(this,"hidesuggestion(@v)");return t.query.set("@v",`'${e}'`),Wn(t)}isFollowing(e,t){const n=wr(this,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v",`'${e}'`),n.query.set("@y",`'${t}'`),n()}setMyProfilePic(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=async e=>{const a=e.target.result;try{await Wn(wr(this,"setmyprofilepicture"),{body:a}),t()}catch(e){n(e)}},a.readAsArrayBuffer(e)})}setSingleValueProfileProperty(e,t,n){return Wn(wr(this,"SetSingleValueProfileProperty"),Un({accountName:e,propertyName:t,propertyValue:n}))}setMultiValuedProfileProperty(e,t,n){return Wn(wr(this,"SetMultiValuedProfileProperty"),Un({accountName:e,propertyName:t,propertyValues:n}))}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}});let Er=class extends Rn{createPersonalSiteEnqueueBulk(e){return Wn(Ar(this,"createpersonalsiteenqueuebulk"),Un({emailIDs:e}))}get ownerUserProfile(){return Wn(this.getParent(Ar,"_api/sp.userprofiles.profileloader.getowneruserprofile"))}get userProfile(){return Wn(Ar(this,"getuserprofile"))}createPersonalSite(e=!1){return Wn(Ar(this,`getuserprofile/createpersonalsiteenque(${e})`))}shareAllSocialData(e){return Wn(Ar(this,`getuserprofile/shareallsocialdata(${e})`))}};Er=ba([ga("_api/sp.userprofiles.profileloader.getprofileloader")],Er);const Ar=(e,t)=>new Er(e,t);let Lr=class extends Rn{async clientPeoplePickerResolveUser(e){const t=kr(this,null);t.concat(".clientpeoplepickerresolveuser");const n=await Wn(t,this.getBodyFrom(e));return JSON.parse("object"==typeof n?n.ClientPeoplePickerResolveUser:n)}async clientPeoplePickerSearchUser(e){const t=kr(this,null);t.concat(".clientpeoplepickersearchuser");const n=await Wn(t,this.getBodyFrom(e));return JSON.parse("object"==typeof n?n.ClientPeoplePickerSearchUser:n)}getBodyFrom(e){return Un({queryParams:e})}};Lr=ba([ga("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],Lr);const kr=(e,t)=>new Lr(e,t);var Mr;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(Mr||(Mr={})),Reflect.defineProperty(_a.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return this.create(wr)}});const Pr=Hn(class extends Vn{constructor(e,t="_api/SP.Publishing.SitePageService"){super(e,t)}getCurrentUserMemberships(){const e=Pr(this,null);return e.concat(".GetCurrentUserMemberships"),e()}});Reflect.defineProperty(_a.prototype,"publishingSitePageService",{get:function(){return this.create(Pr)}});let Tr=class extends Vn{get timeZone(){return Hr(this)}get timeZones(){return Nr(this)}async getInstalledLanguages(){return(await jn(this,"installedlanguages")()).Items}};Tr=ba([ga("regionalsettings")],Tr);const Ur=Hn(Tr);let Fr=class extends Vn{async utcToLocalTime(e){let t;t="string"==typeof e?e:e.toISOString();const n=await Wn(Hr(this,`utctolocaltime('${t}')`));return qt(n,"UTCToLocalTime")?n.UTCToLocalTime:n}async localTimeToUTC(e){let t;t="string"==typeof e?e:Rt(e,"minute",-1*e.getTimezoneOffset()).toISOString();const n=await Wn(Hr(this,`localtimetoutc('${t}')`));return qt(n,"LocalTimeToUTC")?n.LocalTimeToUTC:n}};Fr=ba([ga("timezone")],Fr);const Hr=Hn(Fr);let Rr=class extends Bn{getById(e){return Wn(Nr(this,`GetById(${e})`))}};Rr=ba([ga("timezones")],Rr);const Nr=Hn(Rr);function Br(e){return function(t){return Wn(Nn(this,`${e}/getValueForUICulture`),Un({cultureName:t}))}}Tn(xa,"regionalSettings",Ur),xa.prototype.titleResource=Br("titleResource"),xa.prototype.descriptionResource=Br("descriptionResource");let jr=class extends Bn{getById(e){return Gr(this).concat(`('${e}')`)}async add(e){const t=await Wn(this,Un(e));return{action:this.getById(t.Id),data:t}}clear(){return Wn(Vr(this,"clear"))}};jr=ba([ga("usercustomactions")],jr);const Vr=Hn(jr);class zr extends Vn{constructor(){super(...arguments),this.delete=Gn()}async update(e){return{data:await qn(this,Un(e)),action:this}}}const Gr=Hn(zr);var Kr,Wr;!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(Kr||(Kr={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(Wr||(Wr={})),zr.prototype.titleResource=Br("titleResource"),zr.prototype.descriptionResource=Br("descriptionResource"),Ka.prototype.titleResource=Br("titleResource"),Ka.prototype.descriptionResource=Br("descriptionResource"),ir.prototype.titleResource=Br("titleResource"),ir.prototype.descriptionResource=Br("descriptionResource"),Qi.prototype.titleResource=Br("nameResource"),Qi.prototype.descriptionResource=Br("descriptionResource");let qr=class extends Rn{getRelatedItems(e,t){const n=Qr(this);return n.concat(".GetRelatedItems"),Wn(n,Un({SourceItemID:t,SourceListName:e}))}getPageOneRelatedItems(e,t){const n=Qr(this);return n.concat(".GetPageOneRelatedItems"),Wn(n,Un({SourceItemID:t,SourceListName:e}))}addSingleLink(e,t,n,a,i,r,o=!1){const s=Qr(this);return s.concat(".AddSingleLink"),Wn(s,Un({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:a,TargetWebUrl:r,TryAddReverseLink:o}))}addSingleLinkToUrl(e,t,n,a=!1){const i=Qr(this);return i.concat(".AddSingleLinkToUrl"),Wn(i,Un({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:a}))}addSingleLinkFromUrl(e,t,n,a=!1){const i=Qr(this);return i.concat(".AddSingleLinkFromUrl"),Wn(i,Un({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:a}))}deleteSingleLink(e,t,n,a,i,r,o=!1){const s=Qr(this);return s.concat(".DeleteSingleLink"),Wn(s,Un({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:a,TargetWebUrl:r,TryDeleteReverseLink:o}))}};qr=ba([ga("_api/SP.RelatedItemManager")],qr);const Qr=e=>new qr("string"==typeof e?va(e):[e,va(e.toUrl())]);var Yr;Reflect.defineProperty(xa.prototype,"relatedItems",{configurable:!0,enumerable:!0,get:function(){return Qr(this)}}),new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),new Map([]);let Jr=Yr=class extends Vn{async run(e){const t=this.parseQuery(e),n=Un({request:{...t,HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}}),a=new Yr([this,this.parentUrl]);var i;a.using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheAlways":"1"},[e,t,n]}),e),(i=function(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}(JSON.stringify(n)).toString(),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheKey":i},[e,t,n]}),e)));const r=await Wn(a,n);return new Xr(r,new Yr([this,this.parentUrl]),t)}fixArrProp(e){return void 0===e?[]:Vt(e)?e:[e]}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e,t}};Jr=Yr=ba([ga("_api/search/postquery"),yn(function(e){return this.run(e)})],Jr),Hn(Jr);class Xr{constructor(e,t,n,a=null,i=null){this._search=t,this._query=n,this._raw=a,this._primary=i,this._raw=e.postquery?e.postquery:e}get ElapsedTime(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0}get RowCount(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.RowCount)||0}get TotalRows(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRows)||0}get TotalRowsIncludingDuplicates(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRowsIncludingDuplicates)||0}get RawSearchResults(){return this._raw}get PrimarySearchResults(){var e,t,n,a;return null===this._primary&&(this._primary=this.formatSearchResults((null===(a=null===(n=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===a?void 0:a.Rows)||null)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const n=void 0!==t?t:qt(this._query,"RowLimit")?this._query.RowLimit:10,a={...this._query,RowLimit:n,StartRow:n*(e-1)};return a.StartRow>this.TotalRows?Promise.resolve(null):this._search.run(a)}formatSearchResults(e){const t=new Array;if(void 0===e||null==e)return[];const n=e.results?e.results:e;for(const e of n){const n=e.Cells.results?e.Cells.results:e.Cells;t.push(n.reduce((e,t)=>(e[t.Key]=t.Value,e),{}))}return t}}let Zr=class extends Vn{async run(e){this.mapQueryToQueryString(e);const t=await this(),n=qt(t,"suggest")?e=>t.suggest[e].results:e=>t[e];return{PeopleNames:n("PeopleNames"),PersonalResults:n("PersonalResults"),Queries:n("Queries")}}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>n=>{qt(e,t)&&this.query.set(n,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};var $r,eo,to;Zr=ba([ga("_api/search/suggest")],Zr),Hn(Zr),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}($r||($r={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(eo||(eo={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(to||(to={}));class no{}no.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",no.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",no.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",no.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",no.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",no.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",no.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",no.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",no.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",no.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",no.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",no.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",no.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",no.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",no.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",_a.prototype.search=function(e){return new Jr(this._root).run(e)},_a.prototype.searchSuggest=function(e){return new Zr(this._root).run("string"==typeof e?{querytext:e}:e)};let ao=class extends Bn{getById(e){return ro(this,`getById(${e})`)}getByEmail(e){return ro(this,`getByEmail('${e}')`)}getByLoginName(e){return ro(this).concat(`('!@v::${e}')`)}removeById(e){return Wn(io(this,`removeById(${e})`))}removeByLoginName(e){const t=io(this,"removeByLoginName(@v)");return t.query.set("@v",`'${e}'`),Wn(t)}async add(e){return await Wn(this,Un({LoginName:e})),this.getByLoginName(e)}};ao=ba([ga("siteusers")],ao);const io=Hn(ao),ro=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Gn()}get groups(){return so(this,"groups")}async update(e){return qn(this,Un(e))}});let oo=class extends Bn{getById(e){return co(this).concat(`(${e})`)}async add(e){return Wn(this,Un(e))}getByName(e){return co(this,`getByName('${e}')`)}removeById(e){return Wn(so(this,`removeById('${e}')`))}removeByLoginName(e){return Wn(so(this,`removeByLoginName('${e}')`))}};oo=ba([ga("sitegroups")],oo);const so=Hn(oo),co=Hn(class extends Vn{get users(){return io(this,"users")}async update(e){return qn(this,Un(e))}setUserAsOwner(e){return Wn(co(this,`SetUserAsOwner(${e})`))}});let lo=class extends Bn{getById(e){return fo(this).concat(`(${e})`)}async add(e,t){await Wn(uo(this,`addroleassignment(principalid=${e}, roledefid=${t})`))}async remove(e,t){await Wn(uo(this,`removeroleassignment(principalid=${e}, roledefid=${t})`))}};lo=ba([ga("roleassignments")],lo);const uo=Hn(lo),fo=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Gn()}get groups(){return so(this,"groups")}get bindings(){return jn(this,"roledefinitionbindings")}});let po=class extends Bn{getById(e){return _o(this,`getById(${e})`)}getByName(e){return _o(this,`getbyname('${e}')`)}getByType(e){return _o(this,`getbytype(${e})`)}async add(e,t,n,a){const i=Un({BasePermissions:{High:a.High.toString(),Low:a.Low.toString()},Description:t,Name:e,Order:n}),r=await Wn(this,i);return{data:r,definition:this.getById(r.Id)}}};po=ba([ga("roledefinitions")],po);const mo=Hn(po),_o=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Gn()}async update(e){const t=["BasePermissions"];if(void 0!==qt(e,t[0])){const n=e[t[0]];n.High=n.High.toString(),n.Low=n.Low.toString()}const n=await qn(this,Un(e));let a=this;return qt(e,"Name")&&(a=this.getParent(mo).getByName(e.Name)),{data:n,definition:a}}});var ho,bo,go,vo,yo,So,Do;async function Io(e){const t=zn(this,"getUserEffectivePermissions(@user)");return t.query.set("@user",`'${e}'`),t()}async function xo(){return Nn(this,"EffectiveBasePermissions")()}async function Co(e=!1,t=!1){return Wn(Nn(this,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`))}async function Oo(){return Wn(Nn(this,"resetroleinheritance"))}async function wo(e,t){const n=await Io.call(this,e);return this.hasPermissions(n,t)}async function Eo(e){const t=await xo.call(this);return this.hasPermissions(t,e)}function Ao(e,t){if(!t)return!0;if(t===ho.FullMask)return!(32767&~e.High)&&65535===e.Low;let n=1;return(t-=1)>=0&&t<32?(n<<=t,!!(e.Low&n)):t>=32&&t<64&&(n<<=t-32,!!(e.High&n))}!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(ho||(ho={})),Tn(Xa,"roleAssignments",uo),Tn(Xa,"firstUniqueAncestorSecurableObject",zn),Xa.prototype.getUserEffectivePermissions=Io,Xa.prototype.getCurrentUserEffectivePermissions=xo,Xa.prototype.breakRoleInheritance=Co,Xa.prototype.resetRoleInheritance=Oo,Xa.prototype.userHasPermissions=wo,Xa.prototype.currentUserHasPermissions=Eo,Xa.prototype.hasPermissions=Ao,Tn(Ka,"roleAssignments",uo),Tn(Ka,"firstUniqueAncestorSecurableObject",zn),Ka.prototype.getUserEffectivePermissions=Io,Ka.prototype.getCurrentUserEffectivePermissions=xo,Ka.prototype.breakRoleInheritance=Co,Ka.prototype.resetRoleInheritance=Oo,Ka.prototype.userHasPermissions=wo,Ka.prototype.currentUserHasPermissions=Eo,Ka.prototype.hasPermissions=Ao,Tn(xa,"roleDefinitions",mo),Tn(xa,"roleAssignments",uo),Tn(xa,"firstUniqueAncestorSecurableObject",zn),xa.prototype.getUserEffectivePermissions=Io,xa.prototype.getCurrentUserEffectivePermissions=xo,xa.prototype.breakRoleInheritance=Co,xa.prototype.resetRoleInheritance=Oo,xa.prototype.userHasPermissions=wo,xa.prototype.currentUserHasPermissions=Eo,xa.prototype.hasPermissions=Ao,function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(bo||(bo={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(go||(go={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(vo||(vo={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(yo||(yo={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(So||(So={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(Do||(Do={})),_i.prototype.shareWith=async function(e,t=bo.View,n=!1,a){return(await this.getItem()).shareWith(e,t,n,a)},_i.prototype.getShareLink=async function(e,t=null){return(await this.getItem()).getShareLink(e,t)},_i.prototype.checkSharingPermissions=async function(e){return(await this.getItem()).checkSharingPermissions(e)},_i.prototype.getSharingInformation=async function(e=null,t,n){return(await this.getItem()).getSharingInformation(e,t,n)},_i.prototype.getObjectSharingSettings=async function(e=!0){return(await this.getItem()).getObjectSharingSettings(e)},_i.prototype.unshare=async function(){return(await this.getItem()).unshare()},_i.prototype.deleteSharingLinkByKind=async function(e){return(await this.getItem()).deleteSharingLinkByKind(e)},_i.prototype.unshareLink=async function(e,t=La){return(await this.getItem()).unshareLink(e,t)};const Lo="odata.id";async function ko(e,t,n=!1){if(n)return Mo(e,t);t={group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0,...t};const a=await Po.apply(e,[t.role,t.group]);Vt(t.loginNames)||(t.loginNames=[t.loginNames]);let i={peoplePickerInput:Wt(t.loginNames.map(e=>({Key:e}))),roleValue:a,url:t.url};return void 0!==t.emailData&&null!==t.emailData&&(i={emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0,...i}),Mo(e,i)}async function Mo(e,t){const n=Ca([e,va(e.toUrl())],"/_api/SP.Web.ShareObject");return Wn(n.expand("UsersWithAccessRequests","GroupsSharedWith"),Un(t))}async function Po(e,t){if(null==t){const t=e===bo.Edit?Do.Contributor:Do.Reader,n=await mo([this,"_api/web"]).select("Id").top(1).filter(`RoleTypeKind eq ${t}`)();if(void 0===n||(null==n?void 0:n.length)<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${n[0].Id}`}switch(t){case Do.Contributor:return`group: ${(await Ca([this,"_api/web"],"associatedmembergroup").select("Id")()).Id}`;case Do.Reader:case Do.Guest:return`group: ${(await Ca([this,"_api/web"],"associatedvisitorgroup").select("Id")()).Id}`;default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}}Vi.prototype.shareWith=async function(e,t=bo.View,n=!1,a){return(await this.getItem(Lo)).shareWith(e,t,n,a)},Vi.prototype.getShareLink=async function(e,t=null){return(await this.getItem(Lo)).getShareLink(e,t)},Vi.prototype.checkSharingPermissions=async function(e){return(await this.getItem(Lo)).checkSharingPermissions(e)},Vi.prototype.getSharingInformation=async function(e,t,n){return(await this.getItem(Lo)).getSharingInformation(e,t,n)},Vi.prototype.getObjectSharingSettings=async function(e=!0){return(await this.getItem(Lo)).getObjectSharingSettings(e)},Vi.prototype.unshare=async function(){return(await this.getItem(Lo)).unshare()},Vi.prototype.deleteSharingLinkByKind=async function(e){return(await this.getItem(Lo)).deleteSharingLinkByKind(e)},Vi.prototype.unshareLink=async function(e,t){return(await this.getItem(Lo)).unshareLink(e,t)},Xa.prototype.shareWith=function(e,t=bo.View,n=!1,a){return async function(e,t,n,a=!1,i=!1,r){Vt(t)||(t=[t]);const o=Wt(t.map(e=>({Key:e}))),s=n===bo.Edit?Do.Contributor:Do.Reader,c=await jn([e,va(e.toUrl())],"_api/web/roledefinitions").select("Id").filter(`RoleTypeKind eq ${s}`)();if(!Vt(c)||c.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${s}`);let d={includeAnonymousLinkInEmail:a,peoplePickerInput:o,propagateAcl:i,roleValue:`role:${c[0].Id}`,useSimplifiedRoles:!0};return void 0!==r&&(d={...d,emailBody:r.body,emailSubject:void 0!==r.subject?r.subject:"",sendEmail:!0}),Wn(zn(e,"shareObject"),Un(d))}(this,e,t,n,!1,a)},Xa.prototype.getShareLink=function(e,t=null){const n=null!==t?t.toISOString():null,a=zn(this,"shareLink");return Wn(a,Un({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}}))},Xa.prototype.checkSharingPermissions=function(e){const t=zn(this,"checkPermissions");return Wn(t,Un({recipients:e}))},Xa.prototype.getSharingInformation=function(e=null,t=[],n=["*"]){const a=zn(this,"getSharingInformation");return Wn(a.select(...n).expand(...t),Un({request:e}))},Xa.prototype.getObjectSharingSettings=function(e=!0){const t=zn(this,"getObjectSharingSettings");return Wn(t,Un({useSimplifiedRoles:e}))},Xa.prototype.unshare=function(){return Wn(zn(this,"unshareObject"))},Xa.prototype.deleteSharingLinkByKind=function(e){return Wn(zn(this,"deleteLinkByKind"),Un({linkKind:e}))},Xa.prototype.unshareLink=function(e,t=La){return Wn(zn(this,"unshareLink"),Un({linkKind:e,shareId:t}))},xa.prototype.shareWith=async function(e,t=bo.View,n){const a=await this.select("Url")();return this.shareObject(Nt(a.Url,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,n)},xa.prototype.shareObject=function(e,t,n,a,i,r=!1,o=!1,s=!0){return ko(this,{emailData:a,group:i,includeAnonymousLinkInEmail:o,loginNames:t,propagateAcl:r,role:n,url:e,useSimplifiedRoles:s})},xa.prototype.shareObjectRaw=function(e){return ko(this,e,!0)},xa.prototype.unshareObject=function(e){return Wn(Ca(this,"unshareObject"),Un({url:e}))};class To extends Rn{constructor(e,t=""){super(e),this._url=Nt(va(this._url),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}run(e){return Wn(this,Un(e,Fn({"Content-Type":"application/json;charset=utf-8"})))}createSiteDesign(e){return Fo(this,"CreateSiteDesign").run({info:e})}applySiteDesign(e,t){return Fo(this,"ApplySiteDesign").run({siteDesignId:e,webUrl:t})}getSiteDesigns(){return Fo(this,"GetSiteDesigns").run({})}getSiteDesignMetadata(e){return Fo(this,"GetSiteDesignMetadata").run({id:e})}updateSiteDesign(e){return Fo(this,"UpdateSiteDesign").run({updateInfo:e})}deleteSiteDesign(e){return Fo(this,"DeleteSiteDesign").run({id:e})}getSiteDesignRights(e){return Fo(this,"GetSiteDesignRights").run({id:e})}grantSiteDesignRights(e,t,n=1){return Fo(this,"GrantSiteDesignRights").run({grantedRights:n.toString(),id:e,principalNames:t})}revokeSiteDesignRights(e,t){return Fo(this,"RevokeSiteDesignRights").run({id:e,principalNames:t})}addSiteDesignTask(e,t){return Fo(this,"AddSiteDesignTask").run({webUrl:e,siteDesignId:t})}addSiteDesignTaskToCurrentWeb(e){return Fo(this,"AddSiteDesignTaskToCurrentWeb").run({siteDesignId:e})}async getSiteDesignTask(e){const t=await Fo(this,"GetSiteDesignTask").run({taskId:e});return qt(t,"ID")?t:null}getSiteDesignRun(e,t){return Fo(this,"GetSiteDesignRun").run({webUrl:e,siteDesignId:t})}getSiteDesignRunStatus(e,t){return Fo(this,"GetSiteDesignRunStatus").run({webUrl:e,runId:t})}}const Uo=(e,t)=>new To(e,t),Fo=(e,t="")=>Uo(e,t);var Ho,Ro,No;!function(e){e[e.Site=0]="Site",e[e.List=1]="List"}(Ho||(Ho={})),function(e){e[e.DarkRed=0]="DarkRed",e[e.Red=1]="Red",e[e.Orange=2]="Orange",e[e.Green=3]="Green",e[e.DarkGreen=4]="DarkGreen",e[e.Teal=5]="Teal",e[e.Blue=6]="Blue",e[e.NavyBlue=7]="NavyBlue",e[e.BluePurple=8]="BluePurple",e[e.DarkBlue=9]="DarkBlue",e[e.Lavendar=10]="Lavendar",e[e.Pink=11]="Pink"}(Ro||(Ro={})),function(e){e[e.Bug=0]="Bug",e[e.Calendar=1]="Calendar",e[e.BullseyeTarget=2]="BullseyeTarget",e[e.ClipboardList=3]="ClipboardList",e[e.Airplane=4]="Airplane",e[e.Rocket=5]="Rocket",e[e.Color=6]="Color",e[e.Insights=7]="Insights",e[e.CubeShape=8]="CubeShape",e[e.TestBeakerSolid=9]="TestBeakerSolid",e[e.Robot=10]="Robot",e[e.Savings=11]="Savings"}(No||(No={})),xa.prototype.getSiteDesignRuns=function(e){return Uo(this,"").getSiteDesignRun(void 0,e)},xa.prototype.addSiteDesignTask=function(e){return Uo(this,"").addSiteDesignTaskToCurrentWeb(e)},xa.prototype.getSiteDesignRunStatus=function(e){return Uo(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(_a.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return this.create(Uo)}}),Tn(xa,"siteGroups",so),Tn(xa,"associatedOwnerGroup",co),Tn(xa,"associatedMemberGroup",co),Tn(xa,"associatedVisitorGroup",co),xa.prototype.createDefaultAssociatedGroups=async function(e,t,n=!1,a=!0,i){await this.breakRoleInheritance(n,a);const r=Ca(this,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return r.query.set("@u",`'${t||""}'`),r.query.set("@v",`'${i||""}'`),r.query.set("@s",`'${e||""}'`),Wn(r)};class Bo extends Rn{constructor(e,t=""){super(e),this._url=Nt(va(this._url),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}run(e){return Wn(this,Un(e))}getSiteScripts(){return Vo(this,"GetSiteScripts").run({})}createSiteScript(e,t,n){return Vo(this,`CreateSiteScript(Title=@title,Description=@desc)?@title='${ya(e)}'&@desc='${ya(t)}'`).run(n)}getSiteScriptMetadata(e){return Vo(this,"GetSiteScriptMetadata").run({id:e})}deleteSiteScript(e){return Vo(this,"DeleteSiteScript").run({id:e})}updateSiteScript(e,t){return t&&(e.Content=JSON.stringify(t)),Vo(this,"UpdateSiteScript").run({updateInfo:e})}getSiteScriptFromList(e){return Vo(this,"GetSiteScriptFromList").run({listUrl:e})}getSiteScriptFromWeb(e,t){return Vo(this,"getSiteScriptFromWeb").run({webUrl:e,info:t})}executeSiteScriptAction(e){return Vo(this,"executeSiteScriptAction").run({actionDefinition:e})}}const jo=(e,t)=>new Bo(e,t),Vo=(e,t="")=>jo(e,t);var zo;!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NoOp=2]="NoOp",e[e.SucceededWithException=3]="SucceededWithException"}(zo||(zo={})),xa.prototype.getSiteScript=async function(e){const t=await this.select("Url")();return jo(this.toUrl(),"").using(dn(this)).getSiteScriptFromWeb(t.Url,e)},Ka.prototype.getSiteScript=async function(){const e=await Wa(this).rootFolder(),t=Nt((await Ca([this,va(this.toUrl())]).select("Url")()).Url,"Lists",e.Name);return jo(this,"").getSiteScriptFromList(t)},Reflect.defineProperty(_a.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return this.create(jo)}}),Tn(xa,"siteUsers",io),Tn(xa,"currentUser",ro),xa.prototype.ensureUser=async function(e){return Wn(Ca(this,"ensureuser"),Un({logonName:e}))},xa.prototype.getUserById=function(e){return ro(this,`getUserById(${e})`)},Reflect.defineProperty(_a.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.create(ci)}});let Go=class extends Vn{get my(){return Qo(this)}async getFollowedSitesUri(){const e=await Wo(this,"FollowedSitesUri")();return e.FollowedSitesUri||e}async getFollowedDocumentsUri(){const e=await Wo(this,"FollowedDocumentsUri")();return e.FollowedDocumentsUri||e}async follow(e){return Wn(Wo(this,"follow"),this.createSocialActorInfoRequestBody(e))}async isFollowed(e){return Wn(Wo(this,"isfollowed"),this.createSocialActorInfoRequestBody(e))}async stopFollowing(e){return Wn(Wo(this,"stopfollowing"),this.createSocialActorInfoRequestBody(e))}createSocialActorInfoRequestBody(e){return Un({actor:{Id:null,...e}})}};Go=ba([ga("_api/social.following")],Go);const Ko=e=>new Go(e),Wo=(e,t)=>new Go(e,t);let qo=class extends Vn{async followed(e){const t=await Yo(this,`followed(types=${e})`)();return qt(t,"Followed")?t.Followed.results:t}async followedCount(e){const t=await Yo(this,`followedcount(types=${e})`)();return t.FollowedCount||t}async followers(){const e=await Yo(this,"followers")();return qt(e,"Followers")?e.Followers.results:e}async suggestions(){const e=await Yo(this,"suggestions")();return qt(e,"Suggestions")?e.Suggestions.results:e}};qo=ba([ga("my")],qo);const Qo=(e,t)=>new qo(e,t),Yo=(e,t)=>new qo(e,t);var Jo,Xo,Zo,$o;!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Jo||(Jo={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Xo||(Xo={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Zo||(Zo={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}($o||($o={})),Reflect.defineProperty(_a.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return this.create(Ko)}});const es=Hn(class extends Rn{constructor(e,t=""){super(e),this._url=Nt(va(this._url),`_api/SP.Utilities.Utility.${t}`)}excute(e){return Wn(this,Un(e))}sendEmail(e){return e.AdditionalHeaders&&(e.AdditionalHeaders=Reflect.ownKeys(e.AdditionalHeaders).map(t=>({Key:t,Value:Reflect.get(e.AdditionalHeaders,t),ValueType:"Edm.String"}))),ts(this,"SendEmail").excute({properties:e})}getCurrentUserEmailAddresses(){return ts(this,"GetCurrentUserEmailAddresses").excute({})}resolvePrincipal(e,t,n,a,i,r=!1){const o={addToUserInfoList:i,input:e,inputIsEmailOnly:a,matchUserInfoList:r,scopes:t,sources:n};return ts(this,"ResolvePrincipalInCurrentContext").excute(o)}searchPrincipals(e,t,n,a,i){const r={groupName:a,input:e,maxCount:i,scopes:t,sources:n};return ts(this,"SearchPrincipalsUsingContextWeb").excute(r)}createEmailBodyForInvitation(e){const t={pageAddress:e};return ts(this,"CreateEmailBodyForInvitation").excute(t)}expandGroupsToPrincipals(e,t=30){const n={inputs:e,maxCount:t};return ts(this,"ExpandGroupsToPrincipals").excute(n)}}),ts=(e,t)=>es(e,t);Reflect.defineProperty(_a.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return this.create(es,"")}});let ns=class extends Bn{getById(e){return is(this).concat(`('${e}')`)}async add(e,t,n){const a={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return n&&(a.clientState=n),Wn(this,Un(a))}};ns=ba([ga("subscriptions")],ns);const as=Hn(ns),is=Hn(class extends Vn{async update(e,t,n){const a={};return e&&(a.expirationDateTime=e),t&&(a.notificationUrl=t),n&&(a.clientState=n),Xn(this,Un(a))}delete(){return Jn(this)}});Tn(Ka,"subscriptions",as),Tn(Ka,"userCustomActions",Vr),Tn(xa,"userCustomActions",Vr),Tn(si,"userCustomActions",Vr);let rs=class extends Bn{async add(e,t=!1,n={}){return Wn(this,Un({PersonalView:t,Title:e,...n}))}getById(e){return ss(this).concat(`('${e}')`)}getByTitle(e){return ss(this,`getByTitle('${ya(e)}')`)}};rs=ba([ga("views")],rs);const os=Hn(rs),ss=Hn(class extends Vn{constructor(){super(...arguments),this.delete=Gn()}get fields(){return ds(this)}async update(e){return await qn(this,Un(e))}renderAsHtml(){return ss(this,"renderashtml")()}setViewXml(e){return Wn(ss(this,"SetViewXml"),Un({viewXml:e}))}});let cs=class extends Bn{getSchemaXml(){return ds(this,"schemaxml")()}add(e){return Wn(ds(this,`addviewfield('${ya(e)}')`))}move(e,t){return Wn(ds(this,"moveviewfieldto"),Un({field:e,index:t}))}removeAll(){return Wn(ds(this,"removeallviewfields"))}remove(e){return Wn(ds(this,`removeviewfield('${ya(e)}')`))}};cs=ba([ga("viewfields")],cs);const ds=Hn(cs);var ls;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(ls||(ls={})),Tn(Ka,"views",os),Tn(Ka,"defaultView",ss),Ka.prototype.getView=function(e){return ss(this,`getView('${e}')`)};class us extends Rn{get scope(){return Nn(this,"Scope")}get webparts(){return ms(this,"webparts")}export(e){return Wn(ps(this,"ExportWebPart"),Un({webPartId:e}))}import(e){return Wn(ps(this,"ImportWebPart"),Un({webPartXml:e}))}}const fs=(e,t)=>new us(e,t),ps=(e,t)=>fs(e,t),ms=Hn(class extends Bn{getById(e){return _s(this,`getbyid('${e}')`)}getByControlId(e){return _s(this,`getByControlId('${e}')`)}}),_s=Hn(class extends Vn{get webpart(){return zn(this,"webpart")}saveChanges(){return Wn(_s(this,"SaveWebPartChanges"))}moveTo(e,t){return Wn(_s(this,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`))}close(){return Wn(_s(this,"CloseWebPart"))}open(){return Wn(_s(this,"OpenWebPart"))}delete(){return Wn(_s(this,"DeleteWebPart"))}});var hs,bs;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(hs||(hs={})),_i.prototype.getLimitedWebPartManager=function(e=hs.Shared){return fs(this,`getLimitedWebPartManager(scope=${e})`)},Reflect.defineProperty(_a.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(Ca)}});var gs=function(e){return console.log("a77aaaaaa"),void 0===bs&&void 0!==e&&(alert("11"),bs=ha().using(function(e){return ja.check("SPFx",e),t=>{var n;return t.using(e=>(e.using(function(e,t=!1){return n=>{const a=async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]};return t?n.on.pre.prepend(a):n.on.pre(a),n}}({Accept:"application/json","Content-Type":"application/json;charset=utf-8"})),e),e=>(e.on.pre(async(e,t,n)=>(t.cache="no-cache",t.credentials="same-origin",[e,t,n])),e.using(e=>(e.on.pre(async function(e,t,n){let a="PnPCoreJS:4.7.0:";const{pathname:i}=new URL(e);return a=i.split("/").filter(e=>!Gt(e)&&["_api","v2.1","v2.0"].indexOf(e)<0).map((e,t,n)=>t===n.length-1?e.replace(/\(.*?$/i,"()"):e[0]).join("."),a.length>32&&(a=a.substring(0,32)),this.log(`Request Tag: ${a}`,0),t.headers={...t.headers,"X-ClientService-ClientTag":a},[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalReject](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolve](e)}),e)),e),function(){const{interval:e,replace:t,retries:n}={replace:!0,interval:200,retries:3};return a=>(t&&a.on.send.clear(),a.on.send(function(t,a){let i,r,o=e,s=0;const c=async()=>{if(s>=n)throw r||new On(`Retry count exceeded (${n}) for this request. ${i.status}: ${i.statusText};`,i);if(s++,void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?o=1e3*parseInt(i.headers.get("Retry-After"),10):o*=2,this.log(`Attempt #${s} to retry request which failed with ${i.status}: ${i.statusText}`,0),await(e=o,new Promise(t=>{setTimeout(t,e)})));try{const e=t.toString();return this.log(`Fetch: ${a.method} ${e}`,0),i=await fetch(e,a),i.ok?i:c()}catch(e){if(/AbortError/.test(e.name))throw e;return r=e,c()}var e};return c()}),a)}(),Cn(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return xn(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),(n=t=>{var n,a,i;if(new RegExp(`^${Nt(e.pageContext.web.absoluteUrl,"/_api")}`,"i").test(t)&&(null===(a=null===(n=null==e?void 0:e.pageContext)||void 0===n?void 0:n.legacyPageContext)||void 0===a?void 0:a.formDigestValue)){const t=new Date(e.pageContext.legacyPageContext.formDigestValue.split(",")[1]);return{value:e.pageContext.legacyPageContext.formDigestValue,expiration:Rt(t,"second",(null===(i=e.pageContext.legacyPageContext)||void 0===i?void 0:i.formDigestTimeoutSeconds)-15||1585)}}},e=>(e.on.pre(async function(e,t,a){return this.on.auth(async(e,t)=>{if(/get/i.test(t.method)||t.headers&&(qt(t.headers,"X-RequestDigest")||qt(t.headers,"Authorization")||qt(t.headers,"X-PnPjs-NoDigest")))return[e,t];const a=e.toString(),i=va(a);let r=Na(Ba.get(i));return!Kt(r)&&jt(n)&&(r=Na(n(a))),Kt(r)||(r=await Wn(Nn([this,Nt(i,"_api/contextinfo")]).using(Dn(),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)),{headers:{Accept:"application/json","X-PnPjs-NoDigest":"1"}}).then(e=>({expiration:Rt(new Date,"second",e.FormDigestTimeoutSeconds),value:e.FormDigestValue}))),Kt(r)&&(t.headers={"X-RequestDigest":r.value,...t.headers},Ba.set(i,r)),[e,t]}),[e,t,a]}),e))),t.on.pre.prepend(async(t,n,a)=>(zt(t)||(t=Nt(e.pageContext.web.absoluteUrl,t)),[t,n,a])),t}}(e))),bs},vs=function(){return vs=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vs.apply(this,arguments)};const ys=function(t){var n=t.context,a=Ut(),i=a.register,r=a.handleSubmit,o=a.reset;return e.createElement("div",null,e.createElement("h2",null,"Create New Program"),e.createElement("form",{onSubmit:r(function(e){return a=function(){var t,a,i;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=gs(n),a=Ft,[4,t.web.lists.getByTitle(a).items.add(e)];case 1:return r.sent(),alert("Program created successfully"),o(),[3,3];case 2:return i=r.sent(),console.error("Error creating program:",i),alert("Error creating program"),[3,3];case 3:return[2]}})},new((t=void 0)||(t=Promise))(function(e,n){function i(e){try{o(a.next(e))}catch(e){n(e)}}function r(e){try{o(a.throw(e))}catch(e){n(e)}}function o(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t(function(e){e(a)})).then(i,r)}o((a=a.apply(undefined,[])).next())});var t,a})},e.createElement("div",null,e.createElement("label",null,"Program Name"),e.createElement("input",vs({},i("Title",{required:!0})))),e.createElement("div",null,e.createElement("label",null,"Start Date"),e.createElement("input",vs({type:"date"},i("StartDate",{required:!0})))),e.createElement("div",null,e.createElement("label",null,"End Date"),e.createElement("input",vs({type:"date"},i("EndDate",{required:!0})))),e.createElement("div",null,e.createElement("label",null,e.createElement("input",vs({type:"checkbox"},i("IsActive"))),"Active")),e.createElement("button",{type:"submit"},"Create Program")))},Ss=function(t){var n=t.context,a=e.useState([]),i=a[0],r=a[1],o=q();return e.useEffect(function(){var e,t;t=function(){var e,t,a,i;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=gs(n),t=Ft,[4,e.web.lists.getByTitle(t).items.select("Id","Title","IsActive")()];case 1:return a=o.sent(),r(a),[3,3];case 2:return i=o.sent(),console.error("Error fetching programs:",i),[3,3];case 3:return[2]}})},new((e=void 0)||(e=Promise))(function(n,a){function i(e){try{o(t.next(e))}catch(e){a(e)}}function r(e){try{o(t.throw(e))}catch(e){a(e)}}function o(t){var a;t.done?n(t.value):(a=t.value,a instanceof e?a:new e(function(e){e(a)})).then(i,r)}o((t=t.apply(undefined,[])).next())})},[n]),e.createElement("div",null,e.createElement("h2",null,"Programs"),e.createElement("ul",null,i.map(function(t){return e.createElement("li",{key:t.Id},e.createElement("span",{onClick:function(){return e=t.Id,void o("/dashboard/program/".concat(e));var e},style:{cursor:"pointer",color:"blue"}},t.Title)," - ",t.IsActive?"Active":"Inactive")})))};var Ds=function(){return Ds=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ds.apply(this,arguments)},Is=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},xs=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};const Cs=function(t){var n=t.context,a=function(){let{matches:t}=e.useContext(j),n=t[t.length-1];return n?n.params:{}}().programId,i=e.useState(null),r=i[0],o=i[1];return e.useEffect(function(){Is(void 0,void 0,void 0,function(){var e,t,i,r;return xs(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=gs(n),t=Ft,[4,e.web.lists.getByTitle(t).items.getById(Number(a)).select("Id","Title","StartDate","EndDate","IsActive")()];case 1:return i=s.sent(),o(i),[3,3];case 2:return r=s.sent(),console.error("Error fetching program:",r),[3,3];case 3:return[2]}})})},[n,a]),r?e.createElement("div",null,e.createElement("h2",null,r.Title),e.createElement("p",null,"Start Date: ",new Date(r.StartDate).toLocaleDateString()),e.createElement("p",null,"End Date: ",new Date(r.EndDate).toLocaleDateString()),e.createElement("p",null,"Status: ",r.IsActive?"Active":"Inactive"),e.createElement("button",{onClick:function(){return Is(void 0,void 0,void 0,function(){var e,t,a;return xs(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=gs(n),t=Ft,[4,e.web.lists.getByTitle(t).items.getById(r.Id).update({IsActive:!r.IsActive})];case 1:return i.sent(),o(Ds(Ds({},r),{IsActive:!r.IsActive})),[3,3];case 2:return a=i.sent(),console.error("Error updating program status:",a),[3,3];case 3:return[2]}})})}},r.IsActive?"End Program":"Start Program")):e.createElement("div",null,"Loading...")},Os=function(t){var n=t.context;return e.createElement("div",null,e.createElement("h1",null,"Program Coordinator Dashboard"),e.createElement("nav",null,e.createElement("ul",null,e.createElement("li",null,e.createElement(Oe,{to:"/dashboard/"},"Program List")),e.createElement("li",null,e.createElement(Oe,{to:"/dashboard/new-program"},"Create New Program")))),e.createElement(oe,null,e.createElement(ie,{path:"/",element:e.createElement(Ss,{context:n})}),e.createElement(ie,{path:"/new-program",element:e.createElement(ys,{context:n})}),e.createElement(ie,{path:"/program/:programId",element:e.createElement(Cs,{context:n})})))},ws=function(t){var n=t.context,a=e.useState([]),i=a[0],r=a[1],o=e.useState(!0),s=o[0],c=o[1];return e.useEffect(function(){var e,t;t=function(){var e,t,a,i,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),[4,(e=gs(n)).web.currentUser()];case 1:return t=s.sent(),a=t.Email,[4,e.web.lists.getByTitle("Participants").items.filter("MentorEmail eq '".concat(a,"'")).select("Id","Title","Status")()];case 2:return i=s.sent(),r(i),[3,5];case 3:return o=s.sent(),console.error("Error fetching participants:",o),[3,5];case 4:return c(!1),[7];case 5:return[2]}})},new((e=void 0)||(e=Promise))(function(n,a){function i(e){try{o(t.next(e))}catch(e){a(e)}}function r(e){try{o(t.throw(e))}catch(e){a(e)}}function o(t){var a;t.done?n(t.value):(a=t.value,a instanceof e?a:new e(function(e){e(a)})).then(i,r)}o((t=t.apply(undefined,[])).next())})},[n]),s?e.createElement("div",null,"Loading participants..."):e.createElement("div",null,e.createElement("h1",null,"Mentor Dashboard"),e.createElement("h2",null,"Your Assigned Participants"),0===i.length?e.createElement("p",null,"You have no assigned participants."):e.createElement("ul",null,i.map(function(t){return e.createElement("li",{key:t.Id},t.Title," - ",t.Status)})))};var Es=function(){return Es=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Es.apply(this,arguments)};const As=function(t){var n=t.context,a=Ut(),i=a.register,r=a.handleSubmit,o=a.reset;return e.createElement("div",null,e.createElement("h2",null,"Add Interview Outcome"),e.createElement("form",{onSubmit:r(function(e){return a=function(){var t,a,i,r,s;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,(t=gs(n)).web.currentUser()];case 1:return a=c.sent(),i=a.Email,r=Ht,[4,t.web.lists.getByTitle(r).items.add({ParticipantId:e.ParticipantId,InterviewerEmail:i,ScheduledDate:e.ScheduledDate,Outcome:e.Outcome,Comments:e.Comments})];case 2:return c.sent(),alert("Interview record added"),o(),[3,4];case 3:return s=c.sent(),console.error("Error adding interview:",s),alert("Error adding interview"),[3,4];case 4:return[2]}})},new((t=void 0)||(t=Promise))(function(e,n){function i(e){try{o(a.next(e))}catch(e){n(e)}}function r(e){try{o(a.throw(e))}catch(e){n(e)}}function o(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t(function(e){e(a)})).then(i,r)}o((a=a.apply(undefined,[])).next())});var t,a})},e.createElement("div",null,e.createElement("label",null,"Participant ID"),e.createElement("input",Es({type:"number"},i("ParticipantId",{required:!0})))),e.createElement("div",null,e.createElement("label",null,"Scheduled Date"),e.createElement("input",Es({type:"date"},i("ScheduledDate",{required:!0})))),e.createElement("div",null,e.createElement("label",null,"Outcome"),e.createElement("select",Es({},i("Outcome",{required:!0})),e.createElement("option",{value:""},"Select"),e.createElement("option",{value:"Passed"},"Passed"),e.createElement("option",{value:"Rejected"},"Rejected"))),e.createElement("div",null,e.createElement("label",null,"Comments"),e.createElement("textarea",Es({},i("Comments")))),e.createElement("button",{type:"submit"},"Submit Outcome")))},Ls=function(t){var n=t.context,a=e.useState([]),i=a[0],r=a[1],o=e.useState(!0),s=o[0],c=o[1];return e.useEffect(function(){var e,t;t=function(){var e,t,a,i,o,s;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(d){switch(d.label){case 0:return d.trys.push([0,3,4,5]),[4,(e=gs(n)).web.currentUser()];case 1:return t=d.sent(),a=t.Email,i=Ht,[4,e.web.lists.getByTitle(i).items.filter("InterviewerEmail eq '".concat(a,"'")).select("Id","ParticipantId","ScheduledDate")()];case 2:return o=d.sent(),r(o),[3,5];case 3:return s=d.sent(),console.error("Error fetching interviews:",s),[3,5];case 4:return c(!1),[7];case 5:return[2]}})},new((e=void 0)||(e=Promise))(function(n,a){function i(e){try{o(t.next(e))}catch(e){a(e)}}function r(e){try{o(t.throw(e))}catch(e){a(e)}}function o(t){var a;t.done?n(t.value):(a=t.value,a instanceof e?a:new e(function(e){e(a)})).then(i,r)}o((t=t.apply(undefined,[])).next())})},[n]),s?e.createElement("div",null,"Loading interviews..."):e.createElement("div",null,e.createElement("h1",null,"Interviewer Dashboard"),e.createElement("h2",null,"Your Scheduled Interviews"),0===i.length?e.createElement("p",null,"You have no scheduled interviews."):e.createElement("ul",null,i.map(function(t){return e.createElement("li",{key:t.Id},"Participant ID: ",t.ParticipantId,", Scheduled Date:"," ",new Date(t.ScheduledDate).toLocaleDateString())})),e.createElement(As,{context:n}))},ks=function(t){var n=t.roles,a=t.context;return e.createElement("div",null,-1!==n.indexOf("Program Coordinator")&&e.createElement(Os,{context:a}),-1!==n.indexOf("Mentor")&&e.createElement(ws,{context:a}),-1!==n.indexOf("Interviewer")&&e.createElement(Ls,{context:a}))},Ms=function(){return e.createElement("div",null,e.createElement("h1",null,"You are not authorized to access this application."),e.createElement("p",null,"Please contact the administrator for access."))},Ps=function(){return e.createElement("div",null,e.createElement("h1",null,"404 - Page Not Found"))},Ts=function(){return e.createElement("div",null,e.createElement("p",null,"Loading..."))},Us=function(t){var n=t.context,a=e.useState([]),i=a[0],r=a[1],o=e.useState(!0),s=o[0],c=o[1];return e.useEffect(function(){var e,t;alert("waaasl"),t=function(){var e,t,a,i,o,s;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(d){switch(d.label){case 0:return d.trys.push([0,3,4,5]),[4,(e=gs(n)).web.currentUser()];case 1:return t=d.sent(),a=t.Email,[4,e.web.lists.getByTitle("UserRoles").items.filter("UserEmail eq '".concat(a,"'")).select("Role")()];case 2:return i=d.sent(),o=i.map(function(e){return e.Role}),r(o),[3,5];case 3:return s=d.sent(),console.error("Error fetching user roles:",s),r([]),[3,5];case 4:return c(!1),[7];case 5:return[2]}})},new((e=void 0)||(e=Promise))(function(n,a){function i(e){try{o(t.next(e))}catch(e){a(e)}}function r(e){try{o(t.throw(e))}catch(e){a(e)}}function o(t){var a;t.done?n(t.value):(a=t.value,a instanceof e?a:new e(function(e){e(a)})).then(i,r)}o((t=t.apply(undefined,[])).next())})},[n]),s?e.createElement(Ts,null):0===i.length?e.createElement(Ms,null):e.createElement(xe,null,e.createElement(oe,null,e.createElement(ie,{path:"/",element:e.createElement(ae,{to:"/dashboard",replace:!0})}),e.createElement(ie,{path:"/dashboard/*",element:e.createElement(ks,{roles:i,context:n})}),e.createElement(ie,{path:"*",element:e.createElement(Ps,null)})))};var Fs,Hs=(Fs=function(e,t){return Fs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Fs(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Fs(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const Rs=function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Hs(a,n),a.prototype.render=function(){var n=e.createElement(Us,{context:this.context}),a=this.domElement;t.s(a).render(n)},a.prototype.onInit=function(){return gs(this.context),n.prototype.onInit.call(this)},a}(n.BaseClientSideWebPart)})(),o})());